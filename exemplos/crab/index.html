<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Allan Vieira 14/0128492" />

<meta name="date" content="2018-05-10" />

<title>Exemplos de Regressão Logística em R - Parte 2</title>

<script src="notebook_crab_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="notebook_crab_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="notebook_crab_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="notebook_crab_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="notebook_crab_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="notebook_crab_files/navigation-1.1/tabsets.js"></script>
<link href="notebook_crab_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="notebook_crab_files/highlightjs-9.12.0/highlight.js"></script>
<link href="notebook_crab_files/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="notebook_crab_files/pagedtable-1.1/js/pagedtable.js"></script>
<script src="notebook_crab_files/htmlwidgets-1.0/htmlwidgets.js"></script>
<script src="notebook_crab_files/plotly-binding-4.7.1/plotly.js"></script>
<script src="notebook_crab_files/typedarray-0.1/typedarray.min.js"></script>
<link href="notebook_crab_files/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="notebook_crab_files/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="notebook_crab_files/plotlyjs-1.29.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="notebook_crab_files/plotlyjs-1.29.2/plotly-latest.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>



<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Exemplos de Regressão Logística em R - Parte 2</h1>
<h3 class="subtitle"><em>Análise de Dados Categorizados</em></h3>
<h4 class="author"><em>Allan Vieira 14/0128492</em></h4>
<h4 class="date"><em>May 10, 2018</em></h4>

</div>


<!-- self_contained: false --- para nao dar pau do plotly com firefox -->
<!-- df_print para as formas de imprimir data frames e tibbles -->
<!-- ver https://rmarkdown.rstudio.com/html_document_format.html -->
<!-- incluir no cabecalho: -->
<!-- always_allow_html: yes  -->
<!--para quando formos passar para pdf -->
<style>
body {
text-align: justify}
</style>
<!-- para justificar texto no markdown -->
<!-- https://stackoverflow.com/questions/43222169/how-to-justify-the-text-to-both-sides-when-knitting-html-in-rmarkdown -->
<!-- <style> -->
<!--   .col2 { -->
<!--     columns: 2 200px;         /* number of columns and width in pixels*/ -->
<!--     -webkit-columns: 2 200px; /* chrome, safari */ -->
<!--     -moz-columns: 2 200px;    /* firefox */ -->
<!--   } -->
<!--   .col3 { -->
<!--     columns: 3 100px; -->
<!--     -webkit-columns: 3 100px; -->
<!--     -moz-columns: 3 100px; -->
<!--   } -->
<!-- </style> -->
<!-- esse de cima funciona no output do RStudio, mas nao nos browsers -->
<!-- tb em: https://stackoverflow.com/questions/31753897/2-column-section-in-r-markdown -->
<hr />
<hr />
<div id="exemplo-dos-carangueijos-horseshoe-crabs" class="section level3">
<h3>2. Exemplo dos Carangueijos (Horseshoe Crabs)</h3>
<hr />
<div id="preparacao-dos-dados" class="section level4">
<h4><strong>Preparação dos dados:</strong></h4>
<pre class="r"><code>library(readr)
library(dplyr)

crabs &lt;- read_table2(&quot;/home/allan/Documents/1S2018/A_DADOS_CATEGORIZADOS/PARTE_GEORGE/parte2/exemplos/crab/crabs.txt&quot;, col_names = FALSE)

crabs &lt;- crabs %&gt;%
  magrittr::set_colnames(c(&quot;color&quot;, &quot;spine&quot;, &quot;width&quot;, &quot;satell&quot;, &quot;weight&quot;)) %&gt;%
  na.omit() %&gt;%
  dplyr::mutate(y = dplyr::if_else(satell &gt; 0, 1, 0), # resposta
                weight = weight/1000, # transformando peso em kg
                color = color - 1) # para escala de color de 1 a 4 


tibble::as.tibble(crabs)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["color"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["spine"],"name":[2],"type":["int"],"align":["right"]},{"label":["width"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["satell"],"name":[4],"type":["int"],"align":["right"]},{"label":["weight"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["y"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"2","2":"3","3":"28.3","4":"8","5":"3.050","6":"1"},{"1":"3","2":"3","3":"24.8","4":"0","5":"2.100","6":"0"},{"1":"1","2":"1","3":"26.5","4":"0","5":"2.350","6":"0"},{"1":"3","2":"3","3":"25.6","4":"0","5":"2.150","6":"0"},{"1":"2","2":"3","3":"28.2","4":"11","5":"3.050","6":"1"},{"1":"1","2":"1","3":"27.1","4":"8","5":"2.950","6":"1"},{"1":"4","2":"3","3":"24.7","4":"0","5":"2.200","6":"0"},{"1":"1","2":"2","3":"25.0","4":"3","5":"2.300","6":"1"},{"1":"4","2":"3","3":"25.8","4":"3","5":"2.000","6":"1"},{"1":"2","2":"1","3":"26.8","4":"5","5":"2.700","6":"1"},{"1":"1","2":"1","3":"29.3","4":"4","5":"3.200","6":"1"},{"1":"2","2":"1","3":"25.7","4":"8","5":"2.000","6":"1"},{"1":"2","2":"3","3":"26.8","4":"0","5":"2.650","6":"0"},{"1":"2","2":"3","3":"27.9","4":"6","5":"2.800","6":"1"},{"1":"1","2":"1","3":"27.7","4":"6","5":"2.500","6":"1"},{"1":"3","2":"3","3":"28.9","4":"4","5":"2.800","6":"1"},{"1":"2","2":"3","3":"28.5","4":"3","5":"3.000","6":"1"},{"1":"2","2":"3","3":"27.7","4":"5","5":"2.900","6":"1"},{"1":"2","2":"1","3":"25.7","4":"5","5":"2.000","6":"1"},{"1":"3","2":"3","3":"26.2","4":"3","5":"2.300","6":"1"},{"1":"3","2":"3","3":"27.1","4":"0","5":"2.550","6":"0"},{"1":"2","2":"3","3":"26.0","4":"5","5":"2.150","6":"1"},{"1":"2","2":"3","3":"29.0","4":"10","5":"3.200","6":"1"},{"1":"2","2":"3","3":"26.2","4":"3","5":"2.400","6":"1"},{"1":"3","2":"3","3":"23.0","4":"0","5":"1.800","6":"0"},{"1":"2","2":"2","3":"22.9","4":"0","5":"1.600","6":"0"},{"1":"3","2":"3","3":"25.7","4":"0","5":"1.200","6":"0"},{"1":"4","2":"3","3":"27.5","4":"0","5":"2.900","6":"0"},{"1":"2","2":"3","3":"25.8","4":"0","5":"2.300","6":"0"},{"1":"4","2":"1","3":"25.5","4":"0","5":"2.750","6":"0"},{"1":"2","2":"1","3":"29.7","4":"5","5":"3.850","6":"1"},{"1":"2","2":"1","3":"28.7","4":"0","5":"3.200","6":"0"},{"1":"3","2":"3","3":"25.5","4":"0","5":"2.250","6":"0"},{"1":"3","2":"3","3":"28.5","4":"1","5":"3.000","6":"1"},{"1":"2","2":"3","3":"27.5","4":"1","5":"2.550","6":"1"},{"1":"3","2":"3","3":"27.3","4":"1","5":"2.900","6":"1"},{"1":"2","2":"3","3":"25.3","4":"2","5":"1.900","6":"1"},{"1":"2","2":"3","3":"27.0","4":"6","5":"2.500","6":"1"},{"1":"2","2":"3","3":"31.9","4":"2","5":"3.325","6":"1"},{"1":"3","2":"3","3":"22.0","4":"0","5":"1.400","6":"0"},{"1":"3","2":"3","3":"23.8","4":"6","5":"1.800","6":"1"},{"1":"2","2":"3","3":"24.2","4":"2","5":"1.650","6":"1"},{"1":"3","2":"3","3":"28.4","4":"3","5":"3.200","6":"1"},{"1":"2","2":"1","3":"24.9","4":"6","5":"2.300","6":"1"},{"1":"2","2":"1","3":"28.0","4":"4","5":"2.900","6":"1"},{"1":"2","2":"3","3":"24.9","4":"0","5":"2.200","6":"0"},{"1":"2","2":"2","3":"25.0","4":"6","5":"2.250","6":"1"},{"1":"2","2":"3","3":"30.5","4":"3","5":"3.325","6":"1"},{"1":"2","2":"3","3":"25.8","4":"0","5":"2.400","6":"0"},{"1":"2","2":"3","3":"29.5","4":"4","5":"3.025","6":"1"},{"1":"2","2":"3","3":"27.6","4":"4","5":"2.850","6":"1"},{"1":"2","2":"1","3":"22.9","4":"0","5":"1.600","6":"0"},{"1":"2","2":"3","3":"28.3","4":"0","5":"3.200","6":"0"},{"1":"3","2":"2","3":"29.8","4":"4","5":"3.500","6":"1"},{"1":"2","2":"3","3":"28.2","4":"8","5":"3.050","6":"1"},{"1":"2","2":"3","3":"25.8","4":"0","5":"2.200","6":"0"},{"1":"3","2":"3","3":"26.1","4":"3","5":"2.750","6":"1"},{"1":"4","2":"3","3":"27.0","4":"0","5":"2.625","6":"0"},{"1":"3","2":"3","3":"22.5","4":"0","5":"1.550","6":"0"},{"1":"3","2":"3","3":"26.0","4":"4","5":"2.600","6":"1"},{"1":"3","2":"2","3":"24.7","4":"0","5":"1.900","6":"0"},{"1":"3","2":"3","3":"24.3","4":"0","5":"2.150","6":"0"},{"1":"4","2":"2","3":"21.0","4":"0","5":"1.850","6":"0"},{"1":"2","2":"3","3":"25.2","4":"1","5":"2.000","6":"1"},{"1":"2","2":"3","3":"27.4","4":"5","5":"2.700","6":"1"},{"1":"2","2":"1","3":"22.5","4":"1","5":"1.600","6":"1"},{"1":"4","2":"3","3":"26.2","4":"0","5":"1.300","6":"0"},{"1":"4","2":"3","3":"27.5","4":"0","5":"2.600","6":"0"},{"1":"1","2":"3","3":"25.8","4":"0","5":"2.600","6":"0"},{"1":"2","2":"1","3":"26.7","4":"5","5":"2.700","6":"1"},{"1":"2","2":"3","3":"27.5","4":"6","5":"3.150","6":"1"},{"1":"3","2":"3","3":"27.5","4":"3","5":"3.100","6":"1"},{"1":"2","2":"1","3":"30.0","4":"5","5":"3.300","6":"1"},{"1":"2","2":"3","3":"28.2","4":"6","5":"2.600","6":"1"},{"1":"2","2":"1","3":"30.3","4":"3","5":"3.600","6":"1"},{"1":"1","2":"1","3":"27.4","4":"6","5":"2.700","6":"1"},{"1":"2","2":"3","3":"28.3","4":"15","5":"3.000","6":"1"},{"1":"2","2":"1","3":"27.8","4":"0","5":"2.750","6":"0"},{"1":"3","2":"3","3":"24.5","4":"5","5":"2.050","6":"1"},{"1":"2","2":"3","3":"28.0","4":"1","5":"2.800","6":"1"},{"1":"2","2":"3","3":"26.2","4":"0","5":"2.400","6":"0"},{"1":"3","2":"3","3":"25.6","4":"7","5":"2.800","6":"1"},{"1":"2","2":"3","3":"25.4","4":"6","5":"2.250","6":"1"},{"1":"3","2":"2","3":"26.0","4":"3","5":"2.200","6":"1"},{"1":"2","2":"3","3":"25.1","4":"5","5":"2.100","6":"1"},{"1":"3","2":"3","3":"23.1","4":"0","5":"1.650","6":"0"},{"1":"4","2":"3","3":"27.0","4":"3","5":"2.250","6":"1"},{"1":"4","2":"3","3":"23.5","4":"0","5":"1.900","6":"0"},{"1":"2","2":"1","3":"26.8","4":"0","5":"2.550","6":"0"},{"1":"3","2":"3","3":"23.1","4":"0","5":"1.550","6":"0"},{"1":"3","2":"3","3":"26.5","4":"1","5":"1.967","6":"1"},{"1":"2","2":"3","3":"28.2","4":"1","5":"2.867","6":"1"},{"1":"2","2":"2","3":"24.7","4":"4","5":"2.550","6":"1"},{"1":"2","2":"3","3":"26.3","4":"1","5":"2.400","6":"1"},{"1":"2","2":"3","3":"26.5","4":"4","5":"2.300","6":"1"},{"1":"3","2":"3","3":"25.7","4":"0","5":"2.100","6":"0"},{"1":"4","2":"3","3":"23.7","4":"0","5":"1.800","6":"0"},{"1":"2","2":"3","3":"25.0","4":"5","5":"2.400","6":"1"},{"1":"1","2":"1","3":"30.2","4":"2","5":"3.275","6":"1"},{"1":"2","2":"3","3":"27.4","4":"3","5":"2.900","6":"1"},{"1":"4","2":"3","3":"22.5","4":"4","5":"1.475","6":"1"},{"1":"1","2":"2","3":"24.5","4":"6","5":"1.950","6":"1"},{"1":"4","2":"3","3":"25.8","4":"10","5":"2.250","6":"1"},{"1":"2","2":"1","3":"28.4","4":"5","5":"3.100","6":"1"},{"1":"2","2":"3","3":"27.5","4":"6","5":"2.625","6":"1"},{"1":"3","2":"3","3":"29.0","4":"3","5":"2.925","6":"1"},{"1":"4","2":"3","3":"25.0","4":"8","5":"2.100","6":"1"},{"1":"3","2":"3","3":"24.0","4":"10","5":"1.900","6":"1"},{"1":"2","2":"3","3":"26.2","4":"0","5":"2.300","6":"0"},{"1":"4","2":"3","3":"24.5","4":"0","5":"1.900","6":"0"},{"1":"2","2":"3","3":"23.9","4":"2","5":"1.850","6":"1"},{"1":"2","2":"3","3":"26.5","4":"4","5":"2.350","6":"1"},{"1":"4","2":"3","3":"25.7","4":"0","5":"2.150","6":"0"},{"1":"3","2":"3","3":"24.1","4":"0","5":"1.800","6":"0"},{"1":"3","2":"3","3":"29.0","4":"4","5":"3.275","6":"1"},{"1":"2","2":"2","3":"24.5","4":"0","5":"2.000","6":"0"},{"1":"1","2":"1","3":"26.0","4":"9","5":"2.300","6":"1"},{"1":"2","2":"3","3":"23.8","4":"0","5":"2.100","6":"0"},{"1":"2","2":"1","3":"23.7","4":"0","5":"1.950","6":"0"},{"1":"2","2":"3","3":"25.8","4":"0","5":"2.650","6":"0"},{"1":"2","2":"1","3":"26.0","4":"14","5":"2.300","6":"1"},{"1":"2","2":"3","3":"29.0","4":"1","5":"3.000","6":"1"},{"1":"2","2":"2","3":"23.2","4":"4","5":"1.950","6":"1"},{"1":"3","2":"3","3":"26.7","4":"2","5":"2.600","6":"1"},{"1":"2","2":"3","3":"28.7","4":"3","5":"3.150","6":"1"},{"1":"2","2":"3","3":"24.9","4":"0","5":"2.100","6":"0"},{"1":"2","2":"2","3":"25.7","4":"0","5":"2.000","6":"0"},{"1":"4","2":"3","3":"23.7","4":"0","5":"1.850","6":"0"},{"1":"4","2":"3","3":"23.4","4":"0","5":"1.900","6":"0"},{"1":"1","2":"1","3":"26.1","4":"5","5":"2.800","6":"1"},{"1":"3","2":"1","3":"28.5","4":"9","5":"3.250","6":"1"},{"1":"2","2":"3","3":"25.0","4":"4","5":"2.100","6":"1"},{"1":"4","2":"3","3":"24.7","4":"5","5":"2.100","6":"1"},{"1":"2","2":"3","3":"22.9","4":"4","5":"1.600","6":"1"},{"1":"2","2":"3","3":"27.2","4":"3","5":"2.700","6":"1"},{"1":"4","2":"3","3":"25.5","4":"0","5":"2.250","6":"0"},{"1":"3","2":"1","3":"27.0","4":"3","5":"2.450","6":"1"},{"1":"2","2":"3","3":"30.0","4":"8","5":"3.050","6":"1"},{"1":"2","2":"1","3":"26.5","4":"0","5":"1.300","6":"0"},{"1":"3","2":"3","3":"23.0","4":"1","5":"1.650","6":"1"},{"1":"3","2":"3","3":"24.2","4":"0","5":"1.900","6":"0"},{"1":"2","2":"3","3":"25.4","4":"4","5":"2.250","6":"1"},{"1":"3","2":"2","3":"24.5","4":"0","5":"2.250","6":"0"},{"1":"3","2":"1","3":"25.9","4":"4","5":"2.550","6":"1"},{"1":"2","2":"3","3":"28.5","4":"0","5":"3.050","6":"0"},{"1":"2","2":"2","3":"24.0","4":"0","5":"1.700","6":"0"},{"1":"4","2":"3","3":"26.7","4":"0","5":"2.450","6":"0"},{"1":"2","2":"1","3":"29.0","4":"1","5":"2.800","6":"1"},{"1":"3","2":"3","3":"24.5","4":"1","5":"2.200","6":"1"},{"1":"2","2":"3","3":"24.5","4":"1","5":"1.600","6":"1"},{"1":"2","2":"1","3":"25.2","4":"1","5":"2.000","6":"1"},{"1":"2","2":"3","3":"29.0","4":"1","5":"3.100","6":"1"},{"1":"2","2":"3","3":"27.8","4":"3","5":"3.250","6":"1"},{"1":"2","2":"3","3":"25.0","4":"2","5":"2.100","6":"1"},{"1":"4","2":"3","3":"29.3","4":"12","5":"3.225","6":"1"},{"1":"3","2":"3","3":"27.0","4":"6","5":"2.500","6":"1"},{"1":"3","2":"3","3":"26.2","4":"0","5":"2.225","6":"0"},{"1":"2","2":"2","3":"25.4","4":"0","5":"2.300","6":"0"},{"1":"2","2":"3","3":"26.2","4":"2","5":"2.025","6":"1"},{"1":"2","2":"3","3":"25.1","4":"0","5":"1.800","6":"0"},{"1":"2","2":"3","3":"27.9","4":"7","5":"3.050","6":"1"},{"1":"3","2":"3","3":"27.2","4":"5","5":"2.400","6":"1"},{"1":"2","2":"1","3":"33.5","4":"7","5":"5.200","6":"1"},{"1":"2","2":"1","3":"24.3","4":"0","5":"2.000","6":"0"},{"1":"2","2":"1","3":"31.7","4":"4","5":"3.725","6":"1"},{"1":"2","2":"3","3":"30.0","4":"9","5":"3.000","6":"1"},{"1":"2","2":"1","3":"23.1","4":"0","5":"2.000","6":"0"},{"1":"2","2":"3","3":"24.7","4":"4","5":"1.950","6":"1"},{"1":"3","2":"3","3":"23.8","4":"0","5":"1.800","6":"0"},{"1":"2","2":"3","3":"26.0","4":"3","5":"2.275","6":"1"},{"1":"2","2":"3","3":"26.5","4":"7","5":"2.750","6":"1"},{"1":"3","2":"3","3":"26.2","4":"2","5":"2.175","6":"1"},{"1":"1","2":"1","3":"28.0","4":"0","5":"2.625","6":"0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p></p>
</div>
<div id="tabelas-de-frequencia-para-as-variaveis-categoricas" class="section level4">
<h4><strong>Tabelas de Frequência para as variáveis categóricas:</strong></h4>
<pre class="r"><code>tabs &lt;- sapply(crabs[, c(&quot;color&quot;, &quot;spine&quot;, &quot;satell&quot;, &quot;y&quot;)], table)

tabs</code></pre>
<pre><code>## $color
## 
##  1  2  3  4 
## 12 95 44 22 
## 
## $spine
## 
##   1   2   3 
##  37  15 121 
## 
## $satell
## 
##  0  1  2  3  4  5  6  7  8  9 10 11 12 14 15 
## 62 16  9 19 19 15 13  4  6  3  3  1  1  1  1 
## 
## $y
## 
##   0   1 
##  62 111</code></pre>
<p></p>
<hr />
</div>
<div id="mo-modelo-logistico-sem-efeito-somente-intercepto" class="section level4">
<h4><strong>MO: MODELO LOGÍSTICO SEM EFEITO (SOMENTE INTERCEPTO)</strong></h4>
<p><strong>Ajuste do modelo:</strong></p>
<pre class="r"><code>M0 &lt;- glm(data=crabs, y ~ 1, family=binomial(link=&quot;logit&quot;))

summary(M0)</code></pre>
<pre><code>## 
## Call:
## glm(formula = y ~ 1, family = binomial(link = &quot;logit&quot;), data = crabs)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.4326  -1.4326   0.9421   0.9421   0.9421  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)   0.5824     0.1585   3.673 0.000239 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 225.76  on 172  degrees of freedom
## Residual deviance: 225.76  on 172  degrees of freedom
## AIC: 227.76
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p><strong>Model Fit Statistics</strong>:</p>
<pre class="r"><code># AIC - no output do modelo ou via:
AIC(M0)</code></pre>
<pre><code>## [1] 227.7585</code></pre>
<pre class="r"><code># -2 Log L
-2*logLik(M0)</code></pre>
<pre><code>## &#39;log Lik.&#39; 225.7585 (df=1)</code></pre>
<hr />
</div>
<div id="m1-modelo-logistico-somente-com-width" class="section level4">
<h4><strong>M1: MODELO LOGÍSTICO SOMENTE COM WIDTH</strong></h4>
<p><strong>Ajuste do modelo:</strong></p>
<pre class="r"><code>M1 &lt;- glm(data=crabs, y ~ width, family=binomial(link=&quot;logit&quot;))

summary(M1)</code></pre>
<pre><code>## 
## Call:
## glm(formula = y ~ width, family = binomial(link = &quot;logit&quot;), data = crabs)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.0281  -1.0458   0.5480   0.9066   1.6942  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -12.3508     2.6287  -4.698 2.62e-06 ***
## width         0.4972     0.1017   4.887 1.02e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 225.76  on 172  degrees of freedom
## Residual deviance: 194.45  on 171  degrees of freedom
## AIC: 198.45
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p><strong>Model Fit Statistics</strong>:</p>
<pre class="r"><code># AIC - no output do modelo ou via:
AIC(M1)</code></pre>
<pre><code>## [1] 198.4527</code></pre>
<pre class="r"><code># -2 Log L
-2*logLik(M1)</code></pre>
<pre><code>## &#39;log Lik.&#39; 194.4527 (df=2)</code></pre>
<p></p>
<p><strong>Testes de hipótese para <span class="math inline">\(\beta\)</span>:</strong></p>
<pre class="r"><code># testes para existência de regressão

# 1) razao de verossimilhancas
library(lmtest)
lrtest(M1)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["#Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["LogLik"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Chisq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chisq)"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"2","2":"-97.22633","3":"NA","4":"NA","5":"NA","_rn_":"1"},{"1":"1","2":"-112.87926","3":"-1","4":"31.30586","5":"2.204134e-08","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code># 2) teste de Wald
waldtest(M1)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Res.Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["F"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"171","2":"NA","3":"NA","4":"NA","_rn_":"1"},{"1":"172","2":"-1","3":"23.88748","4":"2.337924e-06","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p></p>
<p><strong>Intervalos de Confiança:</strong></p>
<p>Para <em>log(odds)</em>:</p>
<pre class="r"><code># IC log(odds)
# summary(model)
# IC_B &lt;- model$coefficients[2] + c(-1,1)*qnorm(0.975)*ASE

# ou
confint.default(M1)</code></pre>
<pre><code>##                   2.5 %     97.5 %
## (Intercept) -17.5030100 -7.1986254
## width         0.2978326  0.6966286</code></pre>
<p></p>
<p>O método <em>.default</em> assume normalidade assintótica, por isso é utilizado.</p>
<p>Para <em>odds ratio</em>:</p>
<pre class="r"><code># IC (odds ratio)

exp(confint.default(M1))</code></pre>
<pre><code>##                    2.5 %       97.5 %
## (Intercept) 2.503452e-08 0.0007476128
## width       1.346936e+00 2.0069749360</code></pre>
<hr />
</div>
<div id="m2.1-modelo-logistico-com-width-e-color-ordinal" class="section level4">
<h4><strong>M2.1: MODELO LOGÍSTICO COM WIDTH E COLOR (ORDINAL)</strong></h4>
</div>
<div id="agresti---introduction-to-cda-2nd---pg.118" class="section level4">
<h4><strong>AGRESTI - INTRODUCTION TO CDA 2ND - PG.118</strong></h4>
<p><strong>Ajuste do modelo:</strong></p>
<pre class="r"><code>M2.1 &lt;- glm(data=crabs, y ~ width + color, family=binomial(link=&quot;logit&quot;))

summary(M2.1)</code></pre>
<pre><code>## 
## Call:
## glm(formula = y ~ width + color, family = binomial(link = &quot;logit&quot;), 
##     data = crabs)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.1692  -0.9889   0.5429   0.8700   1.9742  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -10.0708     2.8068  -3.588 0.000333 ***
## width         0.4583     0.1040   4.406 1.05e-05 ***
## color        -0.5090     0.2237  -2.276 0.022860 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 225.76  on 172  degrees of freedom
## Residual deviance: 189.12  on 170  degrees of freedom
## AIC: 195.12
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p><strong>Model Fit Statistics</strong>:</p>
<pre class="r"><code># AIC - no output do modelo ou via:
AIC(M2.1)</code></pre>
<pre><code>## [1] 195.1212</code></pre>
<pre class="r"><code># -2 Log L
-2*logLik(M2.1)</code></pre>
<pre><code>## &#39;log Lik.&#39; 189.1212 (df=3)</code></pre>
<p></p>
<p><strong>Testes de hipótese para <span class="math inline">\(\beta\)</span>:</strong></p>
<pre class="r"><code># testes para existência de regressão

# 1) razao de verossimilhancas
library(lmtest)
lrtest(M2.1)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["#Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["LogLik"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Chisq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chisq)"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"3","2":"-94.56059","3":"NA","4":"NA","5":"NA","_rn_":"1"},{"1":"1","2":"-112.87926","3":"-2","4":"36.63735","5":"1.107392e-08","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code># 2) teste de Wald
waldtest(M2.1)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Res.Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["F"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"170","2":"NA","3":"NA","4":"NA","_rn_":"1"},{"1":"172","2":"-2","3":"13.53079","4":"3.523644e-06","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p></p>
<p><strong>Intervalos de Confiança:</strong></p>
<p>Para <em>log(odds)</em>:</p>
<pre class="r"><code># IC log(odds)
# summary(model)
# IC_B &lt;- model$coefficients[2] + c(-1,1)*qnorm(0.975)*ASE

# ou
confint.default(M2.1)</code></pre>
<pre><code>##                   2.5 %      97.5 %
## (Intercept) -15.5721323 -4.56954567
## width         0.2544380  0.66218152
## color        -0.9474549 -0.07063853</code></pre>
<p></p>
<p>O método <em>.default</em> assume normalidade assintótica, por isso é utilizado.</p>
<p>Para <em>odds ratio</em>:</p>
<pre class="r"><code># IC (odds ratio)

exp(confint.default(M2.1))</code></pre>
<pre><code>##                    2.5 %     97.5 %
## (Intercept) 1.726271e-07 0.01036267
## width       1.289737e+00 1.93901774
## color       3.877266e-01 0.93179864</code></pre>
<p><strong>Curvas Logísticas (segundo COLOR)</strong></p>
<p>Apenas para os valores preditos:</p>
<pre class="r"><code>crabs %&gt;%
  dplyr::mutate(color = factor(color, labels = c(&quot;Lt Med&quot;, &quot;Medium&quot;, &quot;Dk Med&quot;, &quot;Dark&quot;))) %&gt;%
  #dplyr::group_by(color) %&gt;%
  plotly::plot_ly(x=~width, y=~M2.1$fitted.values, #group=~color,
                           type=&quot;scatter&quot;, mode=&quot;markers&quot;, #color=~color, 
          split=~color) %&gt;%
  plotly::layout(title = &quot;Valores Preditos - COLOR(ORDINAL)&quot;)</code></pre>
<div id="400f3ea48ab" style="width:864px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="400f3ea48ab">{"x":{"visdat":{"400f2db9f865":["function () ","plotlyVisDat"]},"cur_data":"400f2db9f865","attrs":{"400f2db9f865":{"x":{},"y":{},"mode":"markers","split":{},"alpha":1,"sizes":[10,100],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Valores Preditos - COLOR(ORDINAL)","xaxis":{"domain":[0,1],"title":"width"},"yaxis":{"domain":[0,1],"title":"M2.1$fitted.values"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[26.5,27.1,25,29.3,27.7,25.8,27.4,30.2,24.5,26,26.1,28],"y":[0.827115757043211,0.862985159030836,0.706378107050752,0.945245735236718,0.89238082035371,0.776347302880803,0.87844657003027,0.963068810818803,0.656718110545115,0.791858987246125,0.799311777521324,0.90489066591157],"mode":"markers","type":"scatter","name":"Lt Med","marker":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y","frame":null},{"x":[28.3,28.2,26.8,25.7,26.8,27.9,28.5,27.7,25.7,26,29,26.2,22.9,25.8,29.7,28.7,27.5,25.3,27,31.9,24.2,24.9,28,24.9,25,30.5,25.8,29.5,27.6,22.9,28.3,28.2,25.8,25.2,27.4,22.5,26.7,27.5,30,28.2,30.3,28.3,27.8,28,26.2,25.4,25.1,26.8,28.2,24.7,26.3,26.5,25,27.4,28.4,27.5,26.2,23.9,26.5,24.5,23.8,23.7,25.8,26,29,23.2,28.7,24.9,25.7,25,22.9,27.2,30,26.5,25.4,28.5,24,29,24.5,25.2,29,27.8,25,25.4,26.2,25.1,27.9,33.5,24.3,31.7,30,23.1,24.7,26,26.5],"y":[0.867752714104975,0.862404032941639,0.767414402502478,0.66588414944628,0.767414402502478,0.845261485301205,0.877921744434533,0.832889734030788,0.66588414944628,0.695745801866733,0.900433455166717,0.714794024647898,0.355800254236927,0.676002043146734,0.92572940557658,0.887410292134742,0.819739775417441,0.623939651501535,0.783372762373113,0.971561156902936,0.500540826629494,0.580050359064062,0.851161531821511,0.580050359064062,0.591171666592426,0.947325668419487,0.676002043146734,0.919176093241232,0.826413098084423,0.355800254236927,0.867752714104975,0.862404032941639,0.676002043146734,0.613126389723728,0.81286799778638,0.314974744438466,0.759134019295927,0.819739775417441,0.93464664678771,0.862404032941639,0.942559678301253,0.867752714104975,0.83917174962487,0.851161531821511,0.714794024647898,0.634630783785759,0.602200436523538,0.767414402502478,0.862404032941639,0.557573054059842,0.724044604715617,0.741978184742114,0.591171666592426,0.81286799778638,0.872924115927511,0.819739775417441,0.714794024647898,0.466219136258664,0.741978184742114,0.534857421094257,0.454833313214334,0.443494522643289,0.676002043146734,0.695745801866733,0.900433455166717,0.387900394721138,0.887410292134742,0.580050359064062,0.66588414944628,0.591171666592426,0.355800254236927,0.798523640645599,0.93464664678771,0.741978184742114,0.634630783785759,0.877921744434533,0.477640263068791,0.900433455166717,0.534857421094257,0.613126389723728,0.900433455166717,0.83917174962487,0.591171666592426,0.634630783785759,0.714794024647898,0.602200436523538,0.845261485301205,0.986135250083266,0.511996267652336,0.968916049432748,0.93464664678771,0.377076083982103,0.557573054059842,0.695745801866733,0.741978184742114],"mode":"markers","type":"scatter","name":"Medium","marker":{"fillcolor":"rgba(255,127,14,1)","color":"rgba(255,127,14,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y","frame":null},{"x":[24.8,25.6,28.9,26.2,27.1,23,25.7,25.5,28.5,27.3,22,23.8,28.4,29.8,26.1,22.5,26,24.7,24.3,27.5,24.5,25.6,26,23.1,23.1,26.5,25.7,29,24,24.1,29,26.7,28.5,27,23,24.2,24.5,25.9,24.5,27,26.2,27.2,23.8,26.2],"y":[0.442284028525691,0.533636679470575,0.838508523229313,0.601024595709659,0.694706289181577,0.257910912340438,0.545023022363475,0.522215182123855,0.812120584925578,0.713792820180372,0.180174628919325,0.333986963199454,0.805027436541473,0.886919186716291,0.589985421986385,0.216528934683187,0.578854833514745,0.431010747206956,0.386736191226373,0.732146167648212,0.408688314092887,0.533636679470575,0.578854833514745,0.266779480169723,0.266779480169723,0.633492461108214,0.545023022363475,0.844618721943007,0.354676568081692,0.365234885444413,0.844618721943007,0.654502716661759,0.812120584925578,0.684900233929625,0.257910912340438,0.375924415393934,0.408688314092887,0.56764351566228,0.408688314092887,0.684900233929625,0.601024595709659,0.704338912211732,0.333986963199454,0.601024595709659],"mode":"markers","type":"scatter","name":"Dk Med","marker":{"fillcolor":"rgba(44,160,44,1)","color":"rgba(44,160,44,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y","frame":null},{"x":[24.7,25.8,27.5,25.5,27,21,26.2,27.5,27,23.5,23.7,22.5,25.8,25,24.5,25.7,23.7,23.4,24.7,25.5,26.7,29.3],"y":[0.312861511702699,0.429808010537109,0.621634596314506,0.396486258286199,0.566439070140064,0.0770926254639483,0.475192732686967,0.621634596314506,0.566439070140064,0.20804553803842,0.223552115887409,0.142453882602459,0.429808010537109,0.343151288382311,0.293501741218977,0.418614042359782,0.223552115887409,0.200595300364406,0.312861511702699,0.396486258286199,0.532415534885077,0.789422777472458],"mode":"markers","type":"scatter","name":"Dark","marker":{"fillcolor":"rgba(214,39,40,1)","color":"rgba(214,39,40,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<pre class="r"><code># plot:
x_limits &lt;- crabs %&gt;%
  summarise(min(width)-2, max(width)+2) # obtendo os limites do eixo x


x &lt;- seq(x_limits[[1]], x_limits[[2]], by=0.1) # criando varios ptos entre esses limites

# x &lt;- seq(20,35, by=0.1) 

# ajustando as probabilidades (y_i&#39;s) para cada nivel de cor i
for (i in 1:4){
  assign(paste0(&quot;y&quot;,i), plogis(M2.1$coefficients[1]+M2.1$coefficients[2]*x+M2.1$coefficients[3]*i)  )
}


y_list &lt;- list(y1,y2,y3,y4)


plotly::plot_ly(x = ~x, y = ~y1, type=&quot;scatter&quot;, mode=&quot;lines&quot;, name=&quot;Lt Med&quot;) %&gt;%
  plotly::add_trace(y=~y2, x=~x , type=&quot;scatter&quot;, mode=&quot;lines&quot;, name=&quot;Medium&quot;) %&gt;%
  plotly::add_trace(y=~y3, x=~x , type=&quot;scatter&quot;, mode=&quot;lines&quot;, name=&quot;Dk Med&quot;) %&gt;%
  plotly::add_trace(y=~y4, x=~x , type=&quot;scatter&quot;, mode=&quot;lines&quot;, name=&quot;Dark&quot;) %&gt;%
  plotly::layout(title = &quot;Curvas Logísticas Ajustadas - COLOR(ORDINAL)&quot;)</code></pre>
<div id="400f1d3949ff" style="width:864px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="400f1d3949ff">{"x":{"visdat":{"400f65faa36b":["function () ","plotlyVisDat"]},"cur_data":"400f65faa36b","attrs":{"400f65faa36b":{"x":{},"y":{},"mode":"lines","name":"Lt Med","alpha":1,"sizes":[10,100],"type":"scatter"},"400f65faa36b.1":{"x":{},"y":{},"mode":"lines","name":"Medium","alpha":1,"sizes":[10,100],"type":"scatter"},"400f65faa36b.2":{"x":{},"y":{},"mode":"lines","name":"Dk Med","alpha":1,"sizes":[10,100],"type":"scatter"},"400f65faa36b.3":{"x":{},"y":{},"mode":"lines","name":"Dark","alpha":1,"sizes":[10,100],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Curvas Logísticas Ajustadas - COLOR(ORDINAL)","xaxis":{"domain":[0,1],"title":"x"},"yaxis":{"domain":[0,1],"title":"y1"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[19,19.1,19.2,19.3,19.4,19.5,19.6,19.7,19.8,19.9,20,20.1,20.2,20.3,20.4,20.5,20.6,20.7,20.8,20.9,21,21.1,21.2,21.3,21.4,21.5,21.6,21.7,21.8,21.9,22,22.1,22.2,22.3,22.4,22.5,22.6,22.7,22.8,22.9,23,23.1,23.2,23.3,23.4,23.5,23.6,23.7,23.8,23.9,24,24.1,24.2,24.3,24.4,24.5,24.6,24.7,24.8,24.9,25,25.1,25.2,25.3,25.4,25.5,25.6,25.7,25.8,25.9,26,26.1,26.2,26.3,26.4,26.5,26.6,26.7,26.8,26.9,27,27.1,27.2,27.3,27.4,27.5,27.6,27.7,27.8,27.9,28,28.1,28.2,28.3,28.4,28.5,28.6,28.7,28.8,28.9,29,29.1,29.2,29.3,29.4,29.5,29.6,29.7,29.8,29.9,30,30.1,30.2,30.3,30.4,30.5,30.6,30.7,30.8,30.9,31,31.1,31.2,31.3,31.4,31.5,31.6,31.7,31.8,31.9,32,32.1,32.2,32.3,32.4,32.5,32.6,32.7,32.8,32.9,33,33.1,33.2,33.3,33.4,33.5,33.6,33.7,33.8,33.9,34,34.1,34.2,34.3,34.4,34.5,34.6,34.7,34.8,34.9,35,35.1,35.2,35.3,35.4,35.5],"y":[0.133310402107006,0.138695208156592,0.144261318148095,0.150011901524177,0.155949941053128,0.162078210648556,0.168399252533362,0.174915353853514,0.181628522863261,0.188540464819843,0.195652557742283,0.20296582820519,0.210480927354419,0.218198107346554,0.226117198428236,0.234237586883892,0.242558194091146,0.251077456931687,0.2597933098112,0.268703168544863,0.277803916364433,0.2870918922988,0.296562882171849,0.306212112449238,0.316034247149189,0.326023388011591,0.336173078094475,0.346476308937611,0.356925531399646,0.367512670238278,0.378229142462881,0.389065879446326,0.400013352738089,0.411061603474939,0.422200275239219,0.433418650169008,0.444705688079971,0.456050068316592,0.46744023401142,0.478864438395871,0.490310792775873,0.501767315760647,0.513221983314101,0.524662779185722,0.53607774527214,0.547455031461555,0.558782944521107,0.57004999560178,0.581244945956271,0.592356850491832,0.60337509881205,0.61428945343781,0.62509008493786,0.635767603742292,0.646313088457247,0.656718110545115,0.666974755280729,0.677075638939602,0.687013922218331,0.696783319929278,0.706378107050752,0.715793121249813,0.725023762026904,0.734065986659652,0.742916303146959,0.751571760374093,0.760029935734577,0.76828892045564,0.776347302880803,0.784204149966132,0.791858987246125,0.799311777521324,0.806562898513087,0.813613119721698,0.820463578712692,0.827115757043211,0.833571456025813,0.839832772511705,0.845902074859365,0.851781979237997,0.857475326398825,0.862985159030836,0.868314699801606,0.873467330168434,0.87844657003027,0.883256058277017,0.887899534279793,0.89238082035371,0.896703805213672,0.900872428433737,0.90489066591157,0.908762516331567,0.912491988613225,0.916083090325294,0.919539817041064,0.922866142605839,0.926066010284085,0.92914332475093,0.932101944890493,0.934945677361989,0.937678270893462,0.940303411262455,0.942824716922778,0.945245735236718,0.947569939272577,0.949800725128192,0.95194140974212,0.953995229155325,0.955965337187577,0.957854804494174,0.95966661797017,0.961403680470845,0.963068810818803,0.964664744069703,0.966194132010276,0.967659543863905,0.969063467180638,0.970408308890064,0.971696396496993,0.972929979401344,0.974111230325058,0.975242246830183,0.976325052913561,0.977361600664787,0.97835377197522,0.97930338028695,0.980212172371629,0.981081830130025,0.981913972404066,0.982710156793978,0.983471881473869,0.984200586999877,0.984897658105626,0.985564425480366,0.986202167525754,0.986812112087721,0.987395438160381,0.987953277559353,0.988486716562292,0.988996797514742,0.989484520399812,0.989950844370431,0.99039668924323,0.99082293695333,0.991230432969546,0.991619987669703,0.991992377675937,0.992348347150015,0.99268860904883,0.993013846340374,0.993324713180559,0.993621836051403,0.993905814861114,0.994177224006726,0.994436613399981,0.994684509457178,0.994921416053797,0.995147815444692,0.995364169150707,0.995570918812569,0.995768487012934,0.995957278067481,0.996137678785922,0.996310059203852,0.996474773286294,0.996632159603853],"mode":"lines","name":"Lt Med","type":"scatter","line":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[19,19.1,19.2,19.3,19.4,19.5,19.6,19.7,19.8,19.9,20,20.1,20.2,20.3,20.4,20.5,20.6,20.7,20.8,20.9,21,21.1,21.2,21.3,21.4,21.5,21.6,21.7,21.8,21.9,22,22.1,22.2,22.3,22.4,22.5,22.6,22.7,22.8,22.9,23,23.1,23.2,23.3,23.4,23.5,23.6,23.7,23.8,23.9,24,24.1,24.2,24.3,24.4,24.5,24.6,24.7,24.8,24.9,25,25.1,25.2,25.3,25.4,25.5,25.6,25.7,25.8,25.9,26,26.1,26.2,26.3,26.4,26.5,26.6,26.7,26.8,26.9,27,27.1,27.2,27.3,27.4,27.5,27.6,27.7,27.8,27.9,28,28.1,28.2,28.3,28.4,28.5,28.6,28.7,28.8,28.9,29,29.1,29.2,29.3,29.4,29.5,29.6,29.7,29.8,29.9,30,30.1,30.2,30.3,30.4,30.5,30.6,30.7,30.8,30.9,31,31.1,31.2,31.3,31.4,31.5,31.6,31.7,31.8,31.9,32,32.1,32.2,32.3,32.4,32.5,32.6,32.7,32.8,32.9,33,33.1,33.2,33.3,33.4,33.5,33.6,33.7,33.8,33.9,34,34.1,34.2,34.3,34.4,34.5,34.6,34.7,34.8,34.9,35,35.1,35.2,35.3,35.4,35.5],"y":[0.0846293964906195,0.0882480508919457,0.0920058825478721,0.0959069001853695,0.099955111624761,0.104154512001144,0.10850907101567,0.113022719198352,0.117699333170323,0.122542719900627,0.127556599960826,0.132744589789871,0.138110182991898,0.14365673070085,0.149387421058033,0.155305257861948,0.161413038463759,0.1677133309967,0.174208451043219,0.18090043785976,0.187791030295473,0.194881642557671,0.202173339993233,0.209666815071119,0.217362363766399,0.225259862560371,0.233358746284065,0.241657987043376,0.250156074472793,0.258850997570847,0.267740228373643,0.276820707722688,0.286088833379554,0.29554045073225,0.305170846326419,0.314974744438466,0.324946306887304,0.335079136256719,0.345366282671417,0.355800254236927,0.366373031216967,0.377076083982103,0.387900394721138,0.398836482862154,0.409874434104455,0.421003932916349,0.432214298307926,0.443494522643289,0.454833313214334,0.466219136258664,0.477640263068791,0.48908481780884,0.500540826629494,0.511996267652336,0.523439121381523,0.534857421094257,0.546239302761781,0.557573054059842,0.568847162041341,0.580050359064062,0.591171666592426,0.602200436523538,0.613126389723728,0.623939651501535,0.634630783785758,0.645190813821991,0.655611259246965,0.66588414944628,0.676002043146734,0.685958042238765,0.695745801866733,0.705359536864235,0.714794024647898,0.724044604715617,0.733107174923757,0.741978184742114,0.750654625705437,0.759134019295927,0.767414402502478,0.775494311309698,0.783372762373113,0.791049233136727,0.798523640645599,0.80579631929971,0.81286799778638,0.81973977541744,0.826413098084423,0.832889734030788,0.83917174962487,0.845261485301205,0.851161531821511,0.856874706990033,0.86240403294164,0.867752714104975,0.872924115927511,0.877921744434533,0.882749226680073,0.887410292134742,0.89190875504323,0.896248497773145,0.900433455166717,0.904467599897838,0.908354928828812,0.912099450354087,0.915705172712119,0.919176093241232,0.92251618855094,0.92572940557658,0.928819653482179,0.931790796374271,0.93464664678771,0.937390959903457,0.940027428457669,0.942559678301254,0.944991264569198,0.947325668419487,0.949566294302172,0.951716467720151,0.953779433444369,0.955758354147488,0.957656309421499,0.959476295146269,0.96122122317761,0.962893921325054,0.964497133591191,0.96603352064603,0.967505660511494,0.968916049432748,0.970267102914626,0.971561156902936,0.972800469091907,0.973987220340415,0.975123516181032,0.976211388407173,0.977252796724882,0.978249630456929,0.979203710288001,0.980116790040785,0.980990558473718,0.981826641092059,0.98262660196481,0.983391945540764,0.984124118457713,0.984824511339484,0.985494460576151,0.986135250083266,0.986748113036555,0.987334233578951,0.987894748497303,0.988430748866512,0.988943281659173,0.989433351319189,0.989901921298083,0.990349915553023,0.990778220005826,0.991187683962413,0.991579121492405,0.991953312768712,0.992311005367123,0.992652915526052,0.992979729366727,0.993292104074181,0.993590669039546,0.993876026964185,0.99414875492631,0.994409405410757],"mode":"lines","name":"Medium","type":"scatter","line":{"fillcolor":"rgba(255,127,14,1)","color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[19,19.1,19.2,19.3,19.4,19.5,19.6,19.7,19.8,19.9,20,20.1,20.2,20.3,20.4,20.5,20.6,20.7,20.8,20.9,21,21.1,21.2,21.3,21.4,21.5,21.6,21.7,21.8,21.9,22,22.1,22.2,22.3,22.4,22.5,22.6,22.7,22.8,22.9,23,23.1,23.2,23.3,23.4,23.5,23.6,23.7,23.8,23.9,24,24.1,24.2,24.3,24.4,24.5,24.6,24.7,24.8,24.9,25,25.1,25.2,25.3,25.4,25.5,25.6,25.7,25.8,25.9,26,26.1,26.2,26.3,26.4,26.5,26.6,26.7,26.8,26.9,27,27.1,27.2,27.3,27.4,27.5,27.6,27.7,27.8,27.9,28,28.1,28.2,28.3,28.4,28.5,28.6,28.7,28.8,28.9,29,29.1,29.2,29.3,29.4,29.5,29.6,29.7,29.8,29.9,30,30.1,30.2,30.3,30.4,30.5,30.6,30.7,30.8,30.9,31,31.1,31.2,31.3,31.4,31.5,31.6,31.7,31.8,31.9,32,32.1,32.2,32.3,32.4,32.5,32.6,32.7,32.8,32.9,33,33.1,33.2,33.3,33.4,33.5,33.6,33.7,33.8,33.9,34,34.1,34.2,34.3,34.4,34.5,34.6,34.7,34.8,34.9,35,35.1,35.2,35.3,35.4,35.5],"y":[0.0526454286360978,0.0549786259135916,0.0574089620875868,0.0599399173623357,0.0625750459568424,0.0653179728507268,0.0681723899610045,0.0711420517096,0.0742307699409184,0.0774424081486211,0.0807808749709484,0.0842501169145361,0.0878541102677759,0.0915968521663919,0.0954823507761389,0.099514614560422,0.103697640604251,0.108035401970344,0.112531834068451,0.117190820025071,0.122016175047881,0.127011629787194,0.132180812705881,0.137527231479274,0.143054253457701,0.148765085236404,0.154662751390719,0.160750072448349,0.167029642185384,0.173503804348191,0.180174628919325,0.18704388806199,0.194113031894103,0.201383164259415,0.208855018679179,0.216528934683187,0.224404834733287,0.232482201965389,0.240760058987155,0.249236947977485,0.257910912340438,0.266779480169723,0.275839649780177,0.285087877559341,0.294520068385015,0.304131568843379,0.313917163466697,0.323871074189695,0.333986963199454,0.344257939325175,0.354676568081692,0.365234885444413,0.375924415393934,0.386736191226373,0.397660780581225,0.408688314092887,0.419808517525764,0.431010747206956,0.442284028525691,0.453617097225987,0.46499844317922,0.4764163562873,0.487858974135749,0.499314330989882,0.510770407707029,0.522215182123855,0.533636679470575,0.545023022363475,0.556362479933563,0.56764351566228,0.578854833514745,0.589985421986385,0.601024595709659,0.611962034303032,0.622787818183728,0.633492461108214,0.64406693924894,0.654502716661759,0.664791767044625,0.674926591733971,0.684900233929625,0.694706289181577,0.704338912211733,0.713792820180372,0.723063292539997,0.732146167648212,0.74103783633607,0.749735232648723,0.758235821991338,0.766537586925035,0.77463901086529,0.782539059939023,0.790237163256734,0.797733191852863,0.805027436541473,0.812120584925578,0.819013697787594,0.825708185075651,0.832205781686346,0.838508523229313,0.844618721943007,0.850538942914733,0.856271980741413,0.861820836751203,0.867188696889964,0.872378910361061,0.877394969092063,0.882240488087833,0.886919186716291,0.8914348709609,0.895791416662656,0.899992753764177,0.904042851559265,0.907945704943122,0.911705321651241,0.915325710468698,0.918810870386257,0.922164780675174,0.925391391848908,0.928494617476934,0.931478326813593,0.934346338203163,0.937102413221223,0.939750251511701,0.942293486278745,0.944735680392713,0.947080323070017,0.949330827087299,0.951490526491381,0.953562674767563,0.955550443430175,0.957456921000694,0.959285112340256,0.961037938304975,0.96271823569408,0.96432875746255,0.965872173171537,0.96735106965151,0.968767951854644,0.970125243874573,0.971425290113105,0.972670356575015,0.973862632273423,0.975004230729626,0.976097191552548,0.977143482084221,0.978144999098833,0.979103570544027,0.980020957314135,0.98089885504602,0.981738895929099,0.982542650521965,0.983311629568835,0.984047285809744,0.984751015779133,0.985424161588056,0.986068012685841,0.986683807597575,0.987272735634222,0.987835938572705,0.988374512303613,0.988889508444627,0.98938193591805,0.989852762491163,0.990302916278393,0.990733287204514],"mode":"lines","name":"Dk Med","type":"scatter","line":{"fillcolor":"rgba(44,160,44,1)","color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[19,19.1,19.2,19.3,19.4,19.5,19.6,19.7,19.8,19.9,20,20.1,20.2,20.3,20.4,20.5,20.6,20.7,20.8,20.9,21,21.1,21.2,21.3,21.4,21.5,21.6,21.7,21.8,21.9,22,22.1,22.2,22.3,22.4,22.5,22.6,22.7,22.8,22.9,23,23.1,23.2,23.3,23.4,23.5,23.6,23.7,23.8,23.9,24,24.1,24.2,24.3,24.4,24.5,24.6,24.7,24.8,24.9,25,25.1,25.2,25.3,25.4,25.5,25.6,25.7,25.8,25.9,26,26.1,26.2,26.3,26.4,26.5,26.6,26.7,26.8,26.9,27,27.1,27.2,27.3,27.4,27.5,27.6,27.7,27.8,27.9,28,28.1,28.2,28.3,28.4,28.5,28.6,28.7,28.8,28.9,29,29.1,29.2,29.3,29.4,29.5,29.6,29.7,29.8,29.9,30,30.1,30.2,30.3,30.4,30.5,30.6,30.7,30.8,30.9,31,31.1,31.2,31.3,31.4,31.5,31.6,31.7,31.8,31.9,32,32.1,32.2,32.3,32.4,32.5,32.6,32.7,32.8,32.9,33,33.1,33.2,33.3,33.4,33.5,33.6,33.7,33.8,33.9,34,34.1,34.2,34.3,34.4,34.5,34.6,34.7,34.8,34.9,35,35.1,35.2,35.3,35.4,35.5],"y":[0.0323223299113784,0.0337869491067911,0.0353155124352318,0.0369105880816942,0.0385748267843726,0.0403109625427142,0.0421218131182123,0.044010280303234,0.0459793499315576,0.0480320916026495,0.0501716580900795,0.0524012844028413,0.0547242864667651,0.0571440593916728,0.0596640752884826,0.0622878805991345,0.0650190929010194,0.0678613971465862,0.0708185412980123,0.0738943313162996,0.0770926254639483,0.0804173278805042,0.0838723813908486,0.0874617595071318,0.0911894575868208,0.095059483111503,0.0990758450538957,0.103242542304057,0.107563551130097,0.112042811653859,0.116684213328048,0.121491579408307,0.126468650421662,0.131619066641738,0.136946349591152,0.142453882602459,0.148144890481102,0.154022418326763,0.160089309583429,0.166348183403199,0.172801411424272,0.179451094079524,0.186299036568461,0.193346724641798,0.200595300364406,0.20804553803842,0.215697820483714,0.223552115887409,0.231607955447119,0.239864412043995,0.248320080190889,0.256973057507667,0.265820927979613,0.274860747255459,0.28408903023869,0.293501741218977,0.303094286779737,0.312861511702699,0.322797698070922,0.332896567747891,0.343151288382311,0.353554483056127,0.364098243657483,0.374774148021235,0.385573280837691,0.396486258286199,0.407503256304652,0.418614042359782,0.42980801053711,0.441074219724438,0.45240143461982,0.463778169254753,0.475192732686967,0.486633276485218,0.498087843601797,0.509544418207581,0.520990976049843,0.532415534885077,0.54380620453797,0.555151236143306,0.566439070140064,0.577658382605742,0.58879812954383,0.599847588767564,0.610796399058135,0.621634596314506,0.632352646454122,0.642941474868213,0.653392492281126,0.663697616909394,0.673849292862052,0.683840504768412,0.69366478866216,0.703316239190803,0.712789513256436,0.722079830227169,0.731182968887947,0.740095261324757,0.748813583957089,0.757335345950078,0.765658475250034,0.773781402495166,0.781703043057493,0.789422777472458,0.796940430509917,0.804256249134358,0.811370879593748,0.818285343865736,0.825001015677376,0.831519596300538,0.837843090310036,0.843973781475629,0.849914208942658,0.855667143839616,0.86123556643447,0.866622643945469,0.87183170909653,0.876866239492336,0.881729837874108,0.886426213303692,0.890959163311284,0.895332557030726,0.899550319336011,0.903616415983302,0.907534839754495,0.911309597591043,0.914944698700414,0.918444143612109,0.921811914155595,0.925051964328683,0.928168212021873,0.931164531561779,0.934044747035007,0.936812626352636,0.939471876014745,0.942026136534141,0.944478978478543,0.946833899090906,0.949094319448259,0.951263582120391,0.953344949290839,0.955341601303924,0.95725663560299,0.959093066026522,0.960853822430367,0.962541750605911,0.96415961246571,0.96571008646968,0.967195768266621,0.968619171527426,0.969982728947912,0.971288793400741,0.972539639217357,0.97373746358232,0.974884388023763,0.975982459984988,0.977033654463493,0.978039875704848,0.979002958939977,0.979924672155446,0.980806717887291,0.981650735029908,0.982458300652302,0.983230931814859,0.983970087380477,0.984677169814631],"mode":"lines","name":"Dark","type":"scatter","line":{"fillcolor":"rgba(214,39,40,1)","color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<hr />
</div>
<div id="m2.2-modelo-logistico-com-width-e-color-nominal" class="section level4">
<h4><strong>M2.2: MODELO LOGÍSTICO COM WIDTH E COLOR (NOMINAL)</strong></h4>
</div>
<div id="agresti---introduction-to-cda-2nd---pg.116" class="section level4">
<h4><strong>AGRESTI - INTRODUCTION TO CDA 2ND - PG.116</strong></h4>
<p><strong>Preparação dos dados:</strong></p>
<pre class="r"><code># soh precisamos tratar color como fator:

crabs2 &lt;- crabs %&gt;%
  dplyr::mutate(color = factor(color, labels = c(&quot;Lt Med&quot;, &quot;Medium&quot;, &quot;Dk Med&quot;, &quot;Dark&quot;)))

head(crabs2)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["color"],"name":[1],"type":["fctr"],"align":["left"]},{"label":["spine"],"name":[2],"type":["int"],"align":["right"]},{"label":["width"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["satell"],"name":[4],"type":["int"],"align":["right"]},{"label":["weight"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["y"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"Medium","2":"3","3":"28.3","4":"8","5":"3.05","6":"1"},{"1":"Dk Med","2":"3","3":"24.8","4":"0","5":"2.10","6":"0"},{"1":"Lt Med","2":"1","3":"26.5","4":"0","5":"2.35","6":"0"},{"1":"Dk Med","2":"3","3":"25.6","4":"0","5":"2.15","6":"0"},{"1":"Medium","2":"3","3":"28.2","4":"11","5":"3.05","6":"1"},{"1":"Lt Med","2":"1","3":"27.1","4":"8","5":"2.95","6":"1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p><strong>Ajuste do modelo:</strong></p>
<pre class="r"><code>M2.2 &lt;- glm(data=crabs2, y ~ width + color, family=binomial(link=&quot;logit&quot;),
            contrasts=list(color=contr.treatment(4, base=4,contrasts=TRUE)))
# base na cor 4 -- dark (0,0,0)

M2.2 &lt;- glm(data=crabs2, y ~ width + color, family=binomial(link=&quot;logit&quot;))

summary(M2.2)</code></pre>
<pre><code>## 
## Call:
## glm(formula = y ~ width + color, family = binomial(link = &quot;logit&quot;), 
##     data = crabs2)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.1124  -0.9848   0.5243   0.8513   2.1413  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -11.38519    2.87346  -3.962 7.43e-05 ***
## width         0.46796    0.10554   4.434 9.26e-06 ***
## colorMedium   0.07242    0.73989   0.098    0.922    
## colorDk Med  -0.22380    0.77708  -0.288    0.773    
## colorDark    -1.32992    0.85252  -1.560    0.119    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 225.76  on 172  degrees of freedom
## Residual deviance: 187.46  on 168  degrees of freedom
## AIC: 197.46
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p><strong>Model Fit Statistics</strong>:</p>
<pre class="r"><code># AIC - no output do modelo ou via:
AIC(M2.2)</code></pre>
<pre><code>## [1] 197.457</code></pre>
<pre class="r"><code># -2 Log L
-2*logLik(M2.2)</code></pre>
<pre><code>## &#39;log Lik.&#39; 187.457 (df=5)</code></pre>
<p></p>
<p><strong>Testes de hipótese para <span class="math inline">\(\beta\)</span>:</strong></p>
<pre class="r"><code># testes para existência de regressão

# 1) razao de verossimilhancas
library(lmtest)
lrtest(M2.2)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["#Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["LogLik"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Chisq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chisq)"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"5","2":"-93.72852","3":"NA","4":"NA","5":"NA","_rn_":"1"},{"1":"1","2":"-112.87926","3":"-4","4":"38.30149","5":"9.710198e-08","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code># 2) teste de Wald
waldtest(M2.2)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Res.Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["F"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"168","2":"NA","3":"NA","4":"NA","_rn_":"1"},{"1":"172","2":"-4","3":"6.919942","4":"3.516506e-05","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p></p>
<p><strong>Intervalos de Confiança:</strong></p>
<p>Para <em>log(odds)</em>:</p>
<pre class="r"><code># IC log(odds)
# summary(model)
# IC_B &lt;- model$coefficients[2] + c(-1,1)*qnorm(0.975)*ASE

# ou
confint.default(M2.2)</code></pre>
<pre><code>##                   2.5 %     97.5 %
## (Intercept) -17.0170654 -5.7533201
## width         0.2610925  0.6748195
## colorMedium  -1.3777452  1.5225790
## colorDk Med  -1.7468443  1.2992490
## colorDark    -3.0008316  0.3409934</code></pre>
<p></p>
<p>O método <em>.default</em> assume normalidade assintótica, por isso é utilizado.</p>
<p>Para <em>odds ratio</em>:</p>
<pre class="r"><code># IC (odds ratio)

exp(confint.default(M2.2))</code></pre>
<pre><code>##                    2.5 %      97.5 %
## (Intercept) 4.069887e-08 0.003172231
## width       1.298348e+00 1.963678538
## colorMedium 2.521465e-01 4.584032380
## colorDk Med 1.743232e-01 3.666542163
## colorDark   4.974568e-02 1.406343935</code></pre>
<p><strong>Curvas Logísticas (segundo COLOR)</strong></p>
<p>Apenas para os valores preditos:</p>
<pre class="r"><code>crabs2 %&gt;%
  # dplyr::mutate(color = factor(color, labels = c(&quot;Lt Med&quot;, &quot;Medium&quot;, &quot;Dk Med&quot;, &quot;Dark&quot;))) %&gt;%
  #dplyr::group_by(color) %&gt;%
  plotly::plot_ly(x=~width, y=~M2.2$fitted.values, #group=~color,
                           type=&quot;scatter&quot;, mode=&quot;markers&quot;, #color=~color, 
          split=~color) %&gt;%
  plotly::layout(title = &quot;Valores Preditos - COLOR(NOMINAL)&quot;)</code></pre>
<div id="400f798b362b" style="width:864px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="400f798b362b">{"x":{"visdat":{"400f2c808d6d":["function () ","plotlyVisDat"]},"cur_data":"400f2c808d6d","attrs":{"400f2c808d6d":{"x":{},"y":{},"mode":"markers","split":{},"alpha":1,"sizes":[10,100],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Valores Preditos - COLOR(NOMINAL)","xaxis":{"domain":[0,1],"title":"width"},"yaxis":{"domain":[0,1],"title":"M2.2$fitted.values"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[26.5,27.1,25,29.3,27.7,25.8,27.4,30.2,24.5,26,26.1,28],"y":[0.73412261735709,0.785230918054823,0.577789803813711,0.911000896994078,0.828805903598926,0.665537817137505,0.807958813164865,0.939748112663099,0.519921664038822,0.686038383517619,0.69602887630279,0.847816192822448],"mode":"markers","type":"scatter","name":"Lt Med","marker":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y","frame":null},{"x":[28.3,28.2,26.8,25.7,26.8,27.9,28.5,27.7,25.7,26,29,26.2,22.9,25.8,29.7,28.7,27.5,25.3,27,31.9,24.2,24.9,28,24.9,25,30.5,25.8,29.5,27.6,22.9,28.3,28.2,25.8,25.2,27.4,22.5,26.7,27.5,30,28.2,30.3,28.3,27.8,28,26.2,25.4,25.1,26.8,28.2,24.7,26.3,26.5,25,27.4,28.4,27.5,26.2,23.9,26.5,24.5,23.8,23.7,25.8,26,29,23.2,28.7,24.9,25.7,25,22.9,27.2,30,26.5,25.4,28.5,24,29,24.5,25.2,29,27.8,25,25.4,26.2,25.1,27.9,33.5,24.3,31.7,30,23.1,24.7,26,26.5],"y":[0.873291313055273,0.868022129179491,0.773546221137904,0.671216660050994,0.773546221137904,0.851092581056584,0.883290865315585,0.838837651563494,0.671216660050994,0.701422268303138,0.905333888947154,0.720646551340506,0.355125660785079,0.681459800823629,0.929923636883282,0.892598328850296,0.825780608607771,0.628668895329175,0.789520205168534,0.973789117707266,0.502939717691136,0.584027324398975,0.856926264869275,0.584027324398975,0.595349234432025,0.950728453080973,0.681459800823629,0.923573841314937,0.832410665033457,0.355125660785079,0.873291313055273,0.868022129179491,0.681459800823629,0.61768057180542,0.818945308954178,0.313508758825718,0.765244163111493,0.825780608607771,0.938537969458463,0.868022129179491,0.946154676954625,0.873291313055273,0.845064041362508,0.856926264869275,0.720646551340506,0.639525710258044,0.606570576527854,0.773546221137904,0.868022129179491,0.561126954362219,0.729969251147476,0.748015810882931,0.595349234432025,0.818945308954178,0.87837960156937,0.825780608607771,0.720646551340506,0.467887316151319,0.748015810882931,0.537963246470679,0.456256274059934,0.444672743849308,0.681459800823629,0.701422268303138,0.905333888947154,0.387888393086684,0.892598328850296,0.584027324398975,0.671216660050994,0.595349234432025,0.355125660785079,0.80465194629334,0.938537969458463,0.748015810882931,0.639525710258044,0.883290865315585,0.479553361139719,0.905333888947154,0.537963246470679,0.61768057180542,0.905333888947154,0.845064041362508,0.595349234432025,0.639525710258044,0.720646551340506,0.606570576527854,0.851092581056584,0.987429467260086,0.514634470061562,0.971291374781801,0.938537969458463,0.376837660239139,0.561126954362219,0.701422268303138,0.748015810882931],"mode":"markers","type":"scatter","name":"Medium","marker":{"fillcolor":"rgba(255,127,14,1)","color":"rgba(255,127,14,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y","frame":null},{"x":[24.8,25.6,28.9,26.2,27.1,23,25.7,25.5,28.5,27.3,22,23.8,28.4,29.8,26.1,22.5,26,24.7,24.3,27.5,24.5,25.6,26,23.1,23.1,26.5,25.7,29,24,24.1,29,26.7,28.5,27,23,24.2,24.5,25.9,24.5,27,26.2,27.2,23.8,26.2],"y":[0.499079501654742,0.591623954336596,0.871572839339061,0.657338579763254,0.745094234064729,0.300272039360042,0.602879693276707,0.580271297373941,0.849125053577275,0.762458903669314,0.211825155150207,0.384228628495463,0.843031549258627,0.911822854658321,0.6467218945347,0.253509657172939,0.635958441365043,0.487383279817809,0.440863089749307,0.778991532609419,0.464044969919528,0.591623954336596,0.635958441365043,0.310195138063873,0.310195138063873,0.688226959271418,0.602879693276707,0.876720395425066,0.406598074920403,0.417936221286653,0.876720395425066,0.707947089760678,0.849125053577275,0.736104940602848,0.300272039360042,0.429361769381493,0.464044969919528,0.625057176849282,0.464044969919528,0.736104940602848,0.657338579763254,0.753879700114022,0.384228628495463,0.657338579763254],"mode":"markers","type":"scatter","name":"Dk Med","marker":{"fillcolor":"rgba(44,160,44,1)","color":"rgba(44,160,44,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y","frame":null},{"x":[24.7,25.8,27.5,25.5,27,21,26.2,27.5,27,23.5,23.7,22.5,25.8,25,24.5,25.7,23.7,23.4,24.7,25.5,26.7,29.3],"y":[0.239285800943137,0.344829031930881,0.538343987874055,0.31383854694065,0.479935703998674,0.0527481544056492,0.38825217258923,0.538343987874055,0.479935703998674,0.152110092219819,0.164577630060427,0.101005473565225,0.344829031930881,0.265765859839147,0.222667204397051,0.334334993597669,0.164577630060427,0.146172487657253,0.239285800943137,0.31383854694065,0.445051057962241,0.730271101057612],"mode":"markers","type":"scatter","name":"Dark","marker":{"fillcolor":"rgba(214,39,40,1)","color":"rgba(214,39,40,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<pre class="r"><code># plot:
x_limits &lt;- crabs2 %&gt;%
  summarise(min(width)-2, max(width)+2) # obtendo os limites do eixo x


x &lt;- seq(x_limits[[1]], x_limits[[2]], by=0.1) # criando varios ptos entre esses limites

# x &lt;- seq(20,35, by=0.1)

# ajustando as probabilidades (y_i&#39;s) para cada nivel de cor i
# temos mais dois coeficientes no modelo agora, mas cuja o valor que multiplica eh 1


y1 &lt;- plogis(M2.2$coefficients[1]+M2.2$coefficients[2]*x) # modelo com color 0 0 0 (base 4 - Dark)

for(j in 2:4){
  assign(paste0(&quot;y&quot;,i), plogis(M2.2$coefficients[1]+M2.2$coefficients[2]*x+M2.2$coefficients[i+1])  )
}



y_list &lt;- list(y1,y2,y3,y4)


plotly::plot_ly(x = ~x, y = ~y1, type=&quot;scatter&quot;, mode=&quot;lines&quot;, name=&quot;Lt Med&quot;) %&gt;%
  plotly::add_trace(y=~y2, x=~x , type=&quot;scatter&quot;, mode=&quot;lines&quot;, name=&quot;Medium&quot;) %&gt;%
  plotly::add_trace(y=~y3, x=~x , type=&quot;scatter&quot;, mode=&quot;lines&quot;, name=&quot;Dk Med&quot;) %&gt;%
  plotly::add_trace(y=~y4, x=~x , type=&quot;scatter&quot;, mode=&quot;lines&quot;, name=&quot;Dark&quot;) %&gt;%
  plotly::layout(title = &quot;Curvas Logísticas Ajustadas - COLOR(NOMINAL)&quot;)</code></pre>
<div id="400f6c93cce8" style="width:864px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="400f6c93cce8">{"x":{"visdat":{"400f686804da":["function () ","plotlyVisDat"]},"cur_data":"400f686804da","attrs":{"400f686804da":{"x":{},"y":{},"mode":"lines","name":"Lt Med","alpha":1,"sizes":[10,100],"type":"scatter"},"400f686804da.1":{"x":{},"y":{},"mode":"lines","name":"Medium","alpha":1,"sizes":[10,100],"type":"scatter"},"400f686804da.2":{"x":{},"y":{},"mode":"lines","name":"Dk Med","alpha":1,"sizes":[10,100],"type":"scatter"},"400f686804da.3":{"x":{},"y":{},"mode":"lines","name":"Dark","alpha":1,"sizes":[10,100],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Curvas Logísticas Ajustadas - COLOR(NOMINAL)","xaxis":{"domain":[0,1],"title":"x"},"yaxis":{"domain":[0,1],"title":"y1"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[19,19.1,19.2,19.3,19.4,19.5,19.6,19.7,19.8,19.9,20,20.1,20.2,20.3,20.4,20.5,20.6,20.7,20.8,20.9,21,21.1,21.2,21.3,21.4,21.5,21.6,21.7,21.8,21.9,22,22.1,22.2,22.3,22.4,22.5,22.6,22.7,22.8,22.9,23,23.1,23.2,23.3,23.4,23.5,23.6,23.7,23.8,23.9,24,24.1,24.2,24.3,24.4,24.5,24.6,24.7,24.8,24.9,25,25.1,25.2,25.3,25.4,25.5,25.6,25.7,25.8,25.9,26,26.1,26.2,26.3,26.4,26.5,26.6,26.7,26.8,26.9,27,27.1,27.2,27.3,27.4,27.5,27.6,27.7,27.8,27.9,28,28.1,28.2,28.3,28.4,28.5,28.6,28.7,28.8,28.9,29,29.1,29.2,29.3,29.4,29.5,29.6,29.7,29.8,29.9,30,30.1,30.2,30.3,30.4,30.5,30.6,30.7,30.8,30.9,31,31.1,31.2,31.3,31.4,31.5,31.6,31.7,31.8,31.9,32,32.1,32.2,32.3,32.4,32.5,32.6,32.7,32.8,32.9,33,33.1,33.2,33.3,33.4,33.5,33.6,33.7,33.8,33.9,34,34.1,34.2,34.3,34.4,34.5,34.6,34.7,34.8,34.9,35,35.1,35.2,35.3,35.4,35.5],"y":[0.0762778271271252,0.0796410968491756,0.0831393138847523,0.0867767015151315,0.0905575088444758,0.0944860002079438,0.0985664435533202,0.10280309776183,0.10720019887873,0.111761945230224,0.116492481410221,0.121395881128631,0.126476128922149,0.131737100739027,0.13718254342107,0.142816053119093,0.14864105269225,0.154660768157044,0.160878204268274,0.167296119331604,0.173916999365727,0.180743031751021,0.187776078520937,0.195017649471872,0.202468875286654,0.210130480885628,0.218002759237326,0.226085545877421,0.234378194399607,0.242879553194814,0.251587943725259,0.260501140626751,0.269616353935994,0.278930213738922,0.288438757530923,0.298137420569926,0.308021029488356,0.318083799409872,0.32831933479142,0.338720634180572,0.349280099042569,0.359989546771202,0.370840227953158,0.381822847907303,0.392927592469246,0.404144157938328,0.415461785049787,0.426869296780304,0.438355139741538,0.449907428864647,0.461513995030352,0.473162435254839,0.484840165002709,0.496534472165261,0.508232572216265,0.519921664038823,0.531588985906231,0.543221871097359,0.554807802632806,0.566334466632078,0.577789803813711,0.589162058689255,0.600439826037566,0.611612094287177,0.622668285480581,0.633598291544158,0.644392506640006,0.65504185543006,0.665537817137505,0.675872445344485,0.686038383517619,0.69602887630279,0.705837776677472,0.715459549091689,0.724889268767069,0.73412261735709,0.743155875199967,0.75198591041897,0.76061016514286,0.76902663913205,0.777233871104022,0.785230918054823,0.793017332872511,0.800593140533545,0.807958813164865,0.815115244243167,0.82206372218917,0.828805903598926,0.835343786336984,0.841679682697767,0.847816192822448,0.853756178539118,0.859502737774575,0.865059179666845,0.870429000488865,0.875615860475815,0.880623561631504,0.885456026573226,0.890117278459571,0.89461142203197,0.8989426257883,0.903115105295576,0.907133107638786,0.911000896994078,0.914722741306849,0.918302900048731,0.921745613021948,0.925055090174939,0.928235502389541,0.931290973197111,0.934225571378946,0.937043304404876,0.9397481126631,0.942343864434007,0.944834351560879,0.947223285770877,0.949514295600616,0.951710923881735,0.953816625743265,0.955834767089131,0.957768623510821,0.959621379597068,0.961396128604216,0.963095872452923,0.964723522018717,0.966281897685922,0.96777373013634,0.96920166134598,0.970568245764975,0.971875951657586,0.973127162580935,0.974324178982752,0.975469219900005,0.97656442474177,0.977611855141157,0.978613496862407,0.979571261750576,0.980486989712405,0.981362450718079,0.982199346814609,0.982999314142568,0.983763924948779,0.984494689588377,0.985193058510479,0.985860424222337,0.986498123227555,0.987107437934506,0.987689598531658,0.988245784826976,0.988777128049071,0.989284712608115,0.989769577814969,0.990232719557267,0.990675091931504,0.991097608830476,0.991501145485622,0.991886539964055,0.992254594620262,0.99260607750261,0.992941723714956,0.993262236733773,0.993568289681342,0.993860526555633,0.994139563417592,0.99440598953663,0.994660368495158],"mode":"lines","name":"Lt Med","type":"scatter","line":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[19,19.1,19.2,19.3,19.4,19.5,19.6,19.7,19.8,19.9,20,20.1,20.2,20.3,20.4,20.5,20.6,20.7,20.8,20.9,21,21.1,21.2,21.3,21.4,21.5,21.6,21.7,21.8,21.9,22,22.1,22.2,22.3,22.4,22.5,22.6,22.7,22.8,22.9,23,23.1,23.2,23.3,23.4,23.5,23.6,23.7,23.8,23.9,24,24.1,24.2,24.3,24.4,24.5,24.6,24.7,24.8,24.9,25,25.1,25.2,25.3,25.4,25.5,25.6,25.7,25.8,25.9,26,26.1,26.2,26.3,26.4,26.5,26.6,26.7,26.8,26.9,27,27.1,27.2,27.3,27.4,27.5,27.6,27.7,27.8,27.9,28,28.1,28.2,28.3,28.4,28.5,28.6,28.7,28.8,28.9,29,29.1,29.2,29.3,29.4,29.5,29.6,29.7,29.8,29.9,30,30.1,30.2,30.3,30.4,30.5,30.6,30.7,30.8,30.9,31,31.1,31.2,31.3,31.4,31.5,31.6,31.7,31.8,31.9,32,32.1,32.2,32.3,32.4,32.5,32.6,32.7,32.8,32.9,33,33.1,33.2,33.3,33.4,33.5,33.6,33.7,33.8,33.9,34,34.1,34.2,34.3,34.4,34.5,34.6,34.7,34.8,34.9,35,35.1,35.2,35.3,35.4,35.5],"y":[0.0846293964906195,0.0882480508919457,0.0920058825478721,0.0959069001853695,0.099955111624761,0.104154512001144,0.10850907101567,0.113022719198352,0.117699333170323,0.122542719900627,0.127556599960826,0.132744589789871,0.138110182991898,0.14365673070085,0.149387421058033,0.155305257861948,0.161413038463759,0.1677133309967,0.174208451043219,0.18090043785976,0.187791030295473,0.194881642557671,0.202173339993233,0.209666815071119,0.217362363766399,0.225259862560371,0.233358746284065,0.241657987043376,0.250156074472793,0.258850997570847,0.267740228373643,0.276820707722688,0.286088833379554,0.29554045073225,0.305170846326419,0.314974744438466,0.324946306887304,0.335079136256719,0.345366282671417,0.355800254236927,0.366373031216967,0.377076083982103,0.387900394721138,0.398836482862154,0.409874434104455,0.421003932916349,0.432214298307926,0.443494522643289,0.454833313214334,0.466219136258664,0.477640263068791,0.48908481780884,0.500540826629494,0.511996267652336,0.523439121381523,0.534857421094257,0.546239302761781,0.557573054059842,0.568847162041341,0.580050359064062,0.591171666592426,0.602200436523538,0.613126389723728,0.623939651501535,0.634630783785758,0.645190813821991,0.655611259246965,0.66588414944628,0.676002043146734,0.685958042238765,0.695745801866733,0.705359536864235,0.714794024647898,0.724044604715617,0.733107174923757,0.741978184742114,0.750654625705437,0.759134019295927,0.767414402502478,0.775494311309698,0.783372762373113,0.791049233136727,0.798523640645599,0.80579631929971,0.81286799778638,0.81973977541744,0.826413098084423,0.832889734030788,0.83917174962487,0.845261485301205,0.851161531821511,0.856874706990033,0.86240403294164,0.867752714104975,0.872924115927511,0.877921744434533,0.882749226680073,0.887410292134742,0.89190875504323,0.896248497773145,0.900433455166717,0.904467599897838,0.908354928828812,0.912099450354087,0.915705172712119,0.919176093241232,0.92251618855094,0.92572940557658,0.928819653482179,0.931790796374271,0.93464664678771,0.937390959903457,0.940027428457669,0.942559678301254,0.944991264569198,0.947325668419487,0.949566294302172,0.951716467720151,0.953779433444369,0.955758354147488,0.957656309421499,0.959476295146269,0.96122122317761,0.962893921325054,0.964497133591191,0.96603352064603,0.967505660511494,0.968916049432748,0.970267102914626,0.971561156902936,0.972800469091907,0.973987220340415,0.975123516181032,0.976211388407173,0.977252796724882,0.978249630456929,0.979203710288001,0.980116790040785,0.980990558473718,0.981826641092059,0.98262660196481,0.983391945540764,0.984124118457713,0.984824511339484,0.985494460576151,0.986135250083266,0.986748113036555,0.987334233578951,0.987894748497303,0.988430748866512,0.988943281659173,0.989433351319189,0.989901921298083,0.990349915553023,0.990778220005826,0.991187683962413,0.991579121492405,0.991953312768712,0.992311005367123,0.992652915526052,0.992979729366727,0.993292104074181,0.993590669039546,0.993876026964185,0.99414875492631,0.994409405410757],"mode":"lines","name":"Medium","type":"scatter","line":{"fillcolor":"rgba(255,127,14,1)","color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[19,19.1,19.2,19.3,19.4,19.5,19.6,19.7,19.8,19.9,20,20.1,20.2,20.3,20.4,20.5,20.6,20.7,20.8,20.9,21,21.1,21.2,21.3,21.4,21.5,21.6,21.7,21.8,21.9,22,22.1,22.2,22.3,22.4,22.5,22.6,22.7,22.8,22.9,23,23.1,23.2,23.3,23.4,23.5,23.6,23.7,23.8,23.9,24,24.1,24.2,24.3,24.4,24.5,24.6,24.7,24.8,24.9,25,25.1,25.2,25.3,25.4,25.5,25.6,25.7,25.8,25.9,26,26.1,26.2,26.3,26.4,26.5,26.6,26.7,26.8,26.9,27,27.1,27.2,27.3,27.4,27.5,27.6,27.7,27.8,27.9,28,28.1,28.2,28.3,28.4,28.5,28.6,28.7,28.8,28.9,29,29.1,29.2,29.3,29.4,29.5,29.6,29.7,29.8,29.9,30,30.1,30.2,30.3,30.4,30.5,30.6,30.7,30.8,30.9,31,31.1,31.2,31.3,31.4,31.5,31.6,31.7,31.8,31.9,32,32.1,32.2,32.3,32.4,32.5,32.6,32.7,32.8,32.9,33,33.1,33.2,33.3,33.4,33.5,33.6,33.7,33.8,33.9,34,34.1,34.2,34.3,34.4,34.5,34.6,34.7,34.8,34.9,35,35.1,35.2,35.3,35.4,35.5],"y":[0.0526454286360978,0.0549786259135916,0.0574089620875868,0.0599399173623357,0.0625750459568424,0.0653179728507268,0.0681723899610045,0.0711420517096,0.0742307699409184,0.0774424081486211,0.0807808749709484,0.0842501169145361,0.0878541102677759,0.0915968521663919,0.0954823507761389,0.099514614560422,0.103697640604251,0.108035401970344,0.112531834068451,0.117190820025071,0.122016175047881,0.127011629787194,0.132180812705881,0.137527231479274,0.143054253457701,0.148765085236404,0.154662751390719,0.160750072448349,0.167029642185384,0.173503804348191,0.180174628919325,0.18704388806199,0.194113031894103,0.201383164259415,0.208855018679179,0.216528934683187,0.224404834733287,0.232482201965389,0.240760058987155,0.249236947977485,0.257910912340438,0.266779480169723,0.275839649780177,0.285087877559341,0.294520068385015,0.304131568843379,0.313917163466697,0.323871074189695,0.333986963199454,0.344257939325175,0.354676568081692,0.365234885444413,0.375924415393934,0.386736191226373,0.397660780581225,0.408688314092887,0.419808517525764,0.431010747206956,0.442284028525691,0.453617097225987,0.46499844317922,0.4764163562873,0.487858974135749,0.499314330989882,0.510770407707029,0.522215182123855,0.533636679470575,0.545023022363475,0.556362479933563,0.56764351566228,0.578854833514745,0.589985421986385,0.601024595709659,0.611962034303032,0.622787818183728,0.633492461108214,0.64406693924894,0.654502716661759,0.664791767044625,0.674926591733971,0.684900233929625,0.694706289181577,0.704338912211733,0.713792820180372,0.723063292539997,0.732146167648212,0.74103783633607,0.749735232648723,0.758235821991338,0.766537586925035,0.77463901086529,0.782539059939023,0.790237163256734,0.797733191852863,0.805027436541473,0.812120584925578,0.819013697787594,0.825708185075651,0.832205781686346,0.838508523229313,0.844618721943007,0.850538942914733,0.856271980741413,0.861820836751203,0.867188696889964,0.872378910361061,0.877394969092063,0.882240488087833,0.886919186716291,0.8914348709609,0.895791416662656,0.899992753764177,0.904042851559265,0.907945704943122,0.911705321651241,0.915325710468698,0.918810870386257,0.922164780675174,0.925391391848908,0.928494617476934,0.931478326813593,0.934346338203163,0.937102413221223,0.939750251511701,0.942293486278745,0.944735680392713,0.947080323070017,0.949330827087299,0.951490526491381,0.953562674767563,0.955550443430175,0.957456921000694,0.959285112340256,0.961037938304975,0.96271823569408,0.96432875746255,0.965872173171537,0.96735106965151,0.968767951854644,0.970125243874573,0.971425290113105,0.972670356575015,0.973862632273423,0.975004230729626,0.976097191552548,0.977143482084221,0.978144999098833,0.979103570544027,0.980020957314135,0.98089885504602,0.981738895929099,0.982542650521965,0.983311629568835,0.984047285809744,0.984751015779133,0.985424161588056,0.986068012685841,0.986683807597575,0.987272735634222,0.987835938572705,0.988374512303613,0.988889508444627,0.98938193591805,0.989852762491163,0.990302916278393,0.990733287204514],"mode":"lines","name":"Dk Med","type":"scatter","line":{"fillcolor":"rgba(44,160,44,1)","color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[19,19.1,19.2,19.3,19.4,19.5,19.6,19.7,19.8,19.9,20,20.1,20.2,20.3,20.4,20.5,20.6,20.7,20.8,20.9,21,21.1,21.2,21.3,21.4,21.5,21.6,21.7,21.8,21.9,22,22.1,22.2,22.3,22.4,22.5,22.6,22.7,22.8,22.9,23,23.1,23.2,23.3,23.4,23.5,23.6,23.7,23.8,23.9,24,24.1,24.2,24.3,24.4,24.5,24.6,24.7,24.8,24.9,25,25.1,25.2,25.3,25.4,25.5,25.6,25.7,25.8,25.9,26,26.1,26.2,26.3,26.4,26.5,26.6,26.7,26.8,26.9,27,27.1,27.2,27.3,27.4,27.5,27.6,27.7,27.8,27.9,28,28.1,28.2,28.3,28.4,28.5,28.6,28.7,28.8,28.9,29,29.1,29.2,29.3,29.4,29.5,29.6,29.7,29.8,29.9,30,30.1,30.2,30.3,30.4,30.5,30.6,30.7,30.8,30.9,31,31.1,31.2,31.3,31.4,31.5,31.6,31.7,31.8,31.9,32,32.1,32.2,32.3,32.4,32.5,32.6,32.7,32.8,32.9,33,33.1,33.2,33.3,33.4,33.5,33.6,33.7,33.8,33.9,34,34.1,34.2,34.3,34.4,34.5,34.6,34.7,34.8,34.9,35,35.1,35.2,35.3,35.4,35.5],"y":[0.0213745466395455,0.0223756411793591,0.0234225006091198,0.0245171097785748,0.0256615293827645,0.0268578978697159,0.0281084332931161,0.0294154350961204,0.0307812858111068,0.0322084526587601,0.0336994890283749,0.03525703581968,0.0368838226248419,0.0385826687275818,0.0403564838945547,0.0422082689323068,0.0441411159812338,0.0461582085160564,0.0482628210203839,0.0504583183010078,0.0527481544056492,0.0551358711060126,0.0576250959062017,0.0602195395348607,0.062922992877849,0.065739323306891,0.0686724703584935,0.0717264407165623,0.0749053024516082,0.0782131784692875,0.0816542391213335,0.0852326939327583,0.0889527824006307,0.0928187638218192,0.0968349061099179,0.101005473565225,0.105334713566176,0.109826842156153,0.11448602850614,0.119316378241326,0.124321915628595,0.129506564631812,0.134874128853077,0.140428270390561,0.146172487657253,0.152110092219819,0.158244184732804,0.164577630060427,0.171113031696189,0.17785270560916,0.184798653665061,0.191952536789665,0.199315648061587,0.206888885940593,0.214672727856001,0.222667204397051,0.230871874362831,0.239285800943137,0.247907529312864,0.256735065930875,0.265765859839147,0.274996786259063,0.284424132778418,0.294043588414896,0.303850235828883,0.31383854694065,0.324002382183692,0.334334993597669,0.344829031930881,0.355476557883843,0.366269057582791,0.377197462325168,0.38825217258923,0.399423086247428,0.41069963086923,0.422070799944449,0.433525192803967,0.445051057962241,0.456636339555993,0.468268726507394,0.479935703998673,0.491624606809447,0.503322674039019,0.515017104714086,0.526695113768284,0.538343987874054,0.549951140609695,0.561504166455008,0.572990893127438,0.584399431796603,0.595718224748003,0.606936090105693,0.618042263267897,0.629026434757953,0.639878784244564,0.650590010538872,0.661151357430461,0.671554635278772,0.681792238329619,0.691857157777688,0.701742990644067,0.71144394458243,0.720954838767822,0.730271101057612,0.739388761644817,0.74830444344941,0.757015349513423,0.765519247680659,0.773814452851783,0.78189980711078,0.789774658019549,0.797438835374121,0.804892626709093,0.812136751826822,0.819172336615226,0.826000886403038,0.832624259084743,0.839044638229405,0.845264506368737,0.851286618640408,0.857113976943081,0.862749804740281,0.868197522631329,0.873460724789213,0.878543156347889,0.883448691804995,0.888181314490572,0.892745097138211,0.897144183581989,0.901382771590852,0.905465096841502,0.909395418021593,0.913178003046857,0.916817116368764,0.920317007343404,0.923681899627278,0.926915981561713,0.930023397504394,0.933008240064156,0.935874543193429,0.938626276091701,0.94126733787281,0.943801552948838,0.946232667083771,0.948564344070796,0.95080016298816,0.952943615989779,0.95499810658827,0.956966948389714,0.958853364241224,0.960660485754206,0.962391353168156,0.964048915521688,0.965636031099515,0.96715546812594,0.968609905677402,0.970001934788409,0.971334059727044,0.972608699417964,0.973828188992485,0.974994781446981,0.976110649392324,0.977177886878587,0.97819851128059,0.979174465231164,0.980107618590244],"mode":"lines","name":"Dark","type":"scatter","line":{"fillcolor":"rgba(214,39,40,1)","color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<hr />
</div>
<div id="selecao-de-variaveis-para-o-modelo-m2.2-modelo-logistico-com-width-e-color-nominal" class="section level4">
<h4><strong>SELEÇÃO DE VARIÁVEIS PARA O MODELO M2.2: MODELO LOGÍSTICO COM WIDTH E COLOR (NOMINAL)</strong></h4>
<p><strong>Preparação dos dados:</strong></p>
<pre class="r"><code># soh precisamos tratar color como fator:
# ficando apenas com as variaveis de interesse y, width, color
crabs3 &lt;- crabs2 %&gt;%
  dplyr::select(y, width, color)


head(crabs3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["y"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["width"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["color"],"name":[3],"type":["fctr"],"align":["left"]}],"data":[{"1":"1","2":"28.3","3":"Medium"},{"1":"0","2":"24.8","3":"Dk Med"},{"1":"0","2":"26.5","3":"Lt Med"},{"1":"0","2":"25.6","3":"Dk Med"},{"1":"1","2":"28.2","3":"Medium"},{"1":"1","2":"27.1","3":"Lt Med"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p><strong>Seleção Automática de Modelos:</strong></p>
<p><em>Backward</em> a partir do modelo completo <em>y <span class="math inline">\(\sim\)</span> width + Lt Med + Medium + Dk Med</em>:</p>
<pre class="r"><code># ajustando os dados
# precisamos fazer isso, para que a funcao step reconheça as variaveis dummy
# step(M2.2) # embora glm reconheça as dummy, a funcao step trata como uma variavel color soh com 3 g.l.

df &lt;- as.data.frame(crabs3)
str(df)</code></pre>
<pre><code>## &#39;data.frame&#39;:    173 obs. of  3 variables:
##  $ y    : num  1 0 0 0 1 1 0 1 1 1 ...
##  $ width: num  28.3 24.8 26.5 25.6 28.2 27.1 24.7 25 25.8 26.8 ...
##  $ color: Factor w/ 4 levels &quot;Lt Med&quot;,&quot;Medium&quot;,..: 2 3 1 3 2 1 4 1 4 2 ...</code></pre>
<pre class="r"><code>m &lt;- model.matrix(~color-1, data=crabs3)
df &lt;- cbind(crabs3[,-3], m[,-4]) # tirando Dark
colnames(df) &lt;- c(&quot;y&quot;, &quot;width&quot;, &quot;Lt_Med&quot;, &quot;Medium&quot;, &quot;Dk_Med&quot;)

tibble::as.tibble(df)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["y"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["width"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Lt_Med"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Medium"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Dk_Med"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"28.3","3":"0","4":"1","5":"0","_rn_":"1"},{"1":"0","2":"24.8","3":"0","4":"0","5":"1","_rn_":"2"},{"1":"0","2":"26.5","3":"1","4":"0","5":"0","_rn_":"3"},{"1":"0","2":"25.6","3":"0","4":"0","5":"1","_rn_":"4"},{"1":"1","2":"28.2","3":"0","4":"1","5":"0","_rn_":"5"},{"1":"1","2":"27.1","3":"1","4":"0","5":"0","_rn_":"6"},{"1":"0","2":"24.7","3":"0","4":"0","5":"0","_rn_":"7"},{"1":"1","2":"25.0","3":"1","4":"0","5":"0","_rn_":"8"},{"1":"1","2":"25.8","3":"0","4":"0","5":"0","_rn_":"9"},{"1":"1","2":"26.8","3":"0","4":"1","5":"0","_rn_":"10"},{"1":"1","2":"29.3","3":"1","4":"0","5":"0","_rn_":"11"},{"1":"1","2":"25.7","3":"0","4":"1","5":"0","_rn_":"12"},{"1":"0","2":"26.8","3":"0","4":"1","5":"0","_rn_":"13"},{"1":"1","2":"27.9","3":"0","4":"1","5":"0","_rn_":"14"},{"1":"1","2":"27.7","3":"1","4":"0","5":"0","_rn_":"15"},{"1":"1","2":"28.9","3":"0","4":"0","5":"1","_rn_":"16"},{"1":"1","2":"28.5","3":"0","4":"1","5":"0","_rn_":"17"},{"1":"1","2":"27.7","3":"0","4":"1","5":"0","_rn_":"18"},{"1":"1","2":"25.7","3":"0","4":"1","5":"0","_rn_":"19"},{"1":"1","2":"26.2","3":"0","4":"0","5":"1","_rn_":"20"},{"1":"0","2":"27.1","3":"0","4":"0","5":"1","_rn_":"21"},{"1":"1","2":"26.0","3":"0","4":"1","5":"0","_rn_":"22"},{"1":"1","2":"29.0","3":"0","4":"1","5":"0","_rn_":"23"},{"1":"1","2":"26.2","3":"0","4":"1","5":"0","_rn_":"24"},{"1":"0","2":"23.0","3":"0","4":"0","5":"1","_rn_":"25"},{"1":"0","2":"22.9","3":"0","4":"1","5":"0","_rn_":"26"},{"1":"0","2":"25.7","3":"0","4":"0","5":"1","_rn_":"27"},{"1":"0","2":"27.5","3":"0","4":"0","5":"0","_rn_":"28"},{"1":"0","2":"25.8","3":"0","4":"1","5":"0","_rn_":"29"},{"1":"0","2":"25.5","3":"0","4":"0","5":"0","_rn_":"30"},{"1":"1","2":"29.7","3":"0","4":"1","5":"0","_rn_":"31"},{"1":"0","2":"28.7","3":"0","4":"1","5":"0","_rn_":"32"},{"1":"0","2":"25.5","3":"0","4":"0","5":"1","_rn_":"33"},{"1":"1","2":"28.5","3":"0","4":"0","5":"1","_rn_":"34"},{"1":"1","2":"27.5","3":"0","4":"1","5":"0","_rn_":"35"},{"1":"1","2":"27.3","3":"0","4":"0","5":"1","_rn_":"36"},{"1":"1","2":"25.3","3":"0","4":"1","5":"0","_rn_":"37"},{"1":"1","2":"27.0","3":"0","4":"1","5":"0","_rn_":"38"},{"1":"1","2":"31.9","3":"0","4":"1","5":"0","_rn_":"39"},{"1":"0","2":"22.0","3":"0","4":"0","5":"1","_rn_":"40"},{"1":"1","2":"23.8","3":"0","4":"0","5":"1","_rn_":"41"},{"1":"1","2":"24.2","3":"0","4":"1","5":"0","_rn_":"42"},{"1":"1","2":"28.4","3":"0","4":"0","5":"1","_rn_":"43"},{"1":"1","2":"24.9","3":"0","4":"1","5":"0","_rn_":"44"},{"1":"1","2":"28.0","3":"0","4":"1","5":"0","_rn_":"45"},{"1":"0","2":"24.9","3":"0","4":"1","5":"0","_rn_":"46"},{"1":"1","2":"25.0","3":"0","4":"1","5":"0","_rn_":"47"},{"1":"1","2":"30.5","3":"0","4":"1","5":"0","_rn_":"48"},{"1":"0","2":"25.8","3":"0","4":"1","5":"0","_rn_":"49"},{"1":"1","2":"29.5","3":"0","4":"1","5":"0","_rn_":"50"},{"1":"1","2":"27.6","3":"0","4":"1","5":"0","_rn_":"51"},{"1":"0","2":"22.9","3":"0","4":"1","5":"0","_rn_":"52"},{"1":"0","2":"28.3","3":"0","4":"1","5":"0","_rn_":"53"},{"1":"1","2":"29.8","3":"0","4":"0","5":"1","_rn_":"54"},{"1":"1","2":"28.2","3":"0","4":"1","5":"0","_rn_":"55"},{"1":"0","2":"25.8","3":"0","4":"1","5":"0","_rn_":"56"},{"1":"1","2":"26.1","3":"0","4":"0","5":"1","_rn_":"57"},{"1":"0","2":"27.0","3":"0","4":"0","5":"0","_rn_":"58"},{"1":"0","2":"22.5","3":"0","4":"0","5":"1","_rn_":"59"},{"1":"1","2":"26.0","3":"0","4":"0","5":"1","_rn_":"60"},{"1":"0","2":"24.7","3":"0","4":"0","5":"1","_rn_":"61"},{"1":"0","2":"24.3","3":"0","4":"0","5":"1","_rn_":"62"},{"1":"0","2":"21.0","3":"0","4":"0","5":"0","_rn_":"63"},{"1":"1","2":"25.2","3":"0","4":"1","5":"0","_rn_":"64"},{"1":"1","2":"27.4","3":"0","4":"1","5":"0","_rn_":"65"},{"1":"1","2":"22.5","3":"0","4":"1","5":"0","_rn_":"66"},{"1":"0","2":"26.2","3":"0","4":"0","5":"0","_rn_":"67"},{"1":"0","2":"27.5","3":"0","4":"0","5":"0","_rn_":"68"},{"1":"0","2":"25.8","3":"1","4":"0","5":"0","_rn_":"69"},{"1":"1","2":"26.7","3":"0","4":"1","5":"0","_rn_":"70"},{"1":"1","2":"27.5","3":"0","4":"1","5":"0","_rn_":"71"},{"1":"1","2":"27.5","3":"0","4":"0","5":"1","_rn_":"72"},{"1":"1","2":"30.0","3":"0","4":"1","5":"0","_rn_":"73"},{"1":"1","2":"28.2","3":"0","4":"1","5":"0","_rn_":"74"},{"1":"1","2":"30.3","3":"0","4":"1","5":"0","_rn_":"75"},{"1":"1","2":"27.4","3":"1","4":"0","5":"0","_rn_":"76"},{"1":"1","2":"28.3","3":"0","4":"1","5":"0","_rn_":"77"},{"1":"0","2":"27.8","3":"0","4":"1","5":"0","_rn_":"78"},{"1":"1","2":"24.5","3":"0","4":"0","5":"1","_rn_":"79"},{"1":"1","2":"28.0","3":"0","4":"1","5":"0","_rn_":"80"},{"1":"0","2":"26.2","3":"0","4":"1","5":"0","_rn_":"81"},{"1":"1","2":"25.6","3":"0","4":"0","5":"1","_rn_":"82"},{"1":"1","2":"25.4","3":"0","4":"1","5":"0","_rn_":"83"},{"1":"1","2":"26.0","3":"0","4":"0","5":"1","_rn_":"84"},{"1":"1","2":"25.1","3":"0","4":"1","5":"0","_rn_":"85"},{"1":"0","2":"23.1","3":"0","4":"0","5":"1","_rn_":"86"},{"1":"1","2":"27.0","3":"0","4":"0","5":"0","_rn_":"87"},{"1":"0","2":"23.5","3":"0","4":"0","5":"0","_rn_":"88"},{"1":"0","2":"26.8","3":"0","4":"1","5":"0","_rn_":"89"},{"1":"0","2":"23.1","3":"0","4":"0","5":"1","_rn_":"90"},{"1":"1","2":"26.5","3":"0","4":"0","5":"1","_rn_":"91"},{"1":"1","2":"28.2","3":"0","4":"1","5":"0","_rn_":"92"},{"1":"1","2":"24.7","3":"0","4":"1","5":"0","_rn_":"93"},{"1":"1","2":"26.3","3":"0","4":"1","5":"0","_rn_":"94"},{"1":"1","2":"26.5","3":"0","4":"1","5":"0","_rn_":"95"},{"1":"0","2":"25.7","3":"0","4":"0","5":"1","_rn_":"96"},{"1":"0","2":"23.7","3":"0","4":"0","5":"0","_rn_":"97"},{"1":"1","2":"25.0","3":"0","4":"1","5":"0","_rn_":"98"},{"1":"1","2":"30.2","3":"1","4":"0","5":"0","_rn_":"99"},{"1":"1","2":"27.4","3":"0","4":"1","5":"0","_rn_":"100"},{"1":"1","2":"22.5","3":"0","4":"0","5":"0","_rn_":"101"},{"1":"1","2":"24.5","3":"1","4":"0","5":"0","_rn_":"102"},{"1":"1","2":"25.8","3":"0","4":"0","5":"0","_rn_":"103"},{"1":"1","2":"28.4","3":"0","4":"1","5":"0","_rn_":"104"},{"1":"1","2":"27.5","3":"0","4":"1","5":"0","_rn_":"105"},{"1":"1","2":"29.0","3":"0","4":"0","5":"1","_rn_":"106"},{"1":"1","2":"25.0","3":"0","4":"0","5":"0","_rn_":"107"},{"1":"1","2":"24.0","3":"0","4":"0","5":"1","_rn_":"108"},{"1":"0","2":"26.2","3":"0","4":"1","5":"0","_rn_":"109"},{"1":"0","2":"24.5","3":"0","4":"0","5":"0","_rn_":"110"},{"1":"1","2":"23.9","3":"0","4":"1","5":"0","_rn_":"111"},{"1":"1","2":"26.5","3":"0","4":"1","5":"0","_rn_":"112"},{"1":"0","2":"25.7","3":"0","4":"0","5":"0","_rn_":"113"},{"1":"0","2":"24.1","3":"0","4":"0","5":"1","_rn_":"114"},{"1":"1","2":"29.0","3":"0","4":"0","5":"1","_rn_":"115"},{"1":"0","2":"24.5","3":"0","4":"1","5":"0","_rn_":"116"},{"1":"1","2":"26.0","3":"1","4":"0","5":"0","_rn_":"117"},{"1":"0","2":"23.8","3":"0","4":"1","5":"0","_rn_":"118"},{"1":"0","2":"23.7","3":"0","4":"1","5":"0","_rn_":"119"},{"1":"0","2":"25.8","3":"0","4":"1","5":"0","_rn_":"120"},{"1":"1","2":"26.0","3":"0","4":"1","5":"0","_rn_":"121"},{"1":"1","2":"29.0","3":"0","4":"1","5":"0","_rn_":"122"},{"1":"1","2":"23.2","3":"0","4":"1","5":"0","_rn_":"123"},{"1":"1","2":"26.7","3":"0","4":"0","5":"1","_rn_":"124"},{"1":"1","2":"28.7","3":"0","4":"1","5":"0","_rn_":"125"},{"1":"0","2":"24.9","3":"0","4":"1","5":"0","_rn_":"126"},{"1":"0","2":"25.7","3":"0","4":"1","5":"0","_rn_":"127"},{"1":"0","2":"23.7","3":"0","4":"0","5":"0","_rn_":"128"},{"1":"0","2":"23.4","3":"0","4":"0","5":"0","_rn_":"129"},{"1":"1","2":"26.1","3":"1","4":"0","5":"0","_rn_":"130"},{"1":"1","2":"28.5","3":"0","4":"0","5":"1","_rn_":"131"},{"1":"1","2":"25.0","3":"0","4":"1","5":"0","_rn_":"132"},{"1":"1","2":"24.7","3":"0","4":"0","5":"0","_rn_":"133"},{"1":"1","2":"22.9","3":"0","4":"1","5":"0","_rn_":"134"},{"1":"1","2":"27.2","3":"0","4":"1","5":"0","_rn_":"135"},{"1":"0","2":"25.5","3":"0","4":"0","5":"0","_rn_":"136"},{"1":"1","2":"27.0","3":"0","4":"0","5":"1","_rn_":"137"},{"1":"1","2":"30.0","3":"0","4":"1","5":"0","_rn_":"138"},{"1":"0","2":"26.5","3":"0","4":"1","5":"0","_rn_":"139"},{"1":"1","2":"23.0","3":"0","4":"0","5":"1","_rn_":"140"},{"1":"0","2":"24.2","3":"0","4":"0","5":"1","_rn_":"141"},{"1":"1","2":"25.4","3":"0","4":"1","5":"0","_rn_":"142"},{"1":"0","2":"24.5","3":"0","4":"0","5":"1","_rn_":"143"},{"1":"1","2":"25.9","3":"0","4":"0","5":"1","_rn_":"144"},{"1":"0","2":"28.5","3":"0","4":"1","5":"0","_rn_":"145"},{"1":"0","2":"24.0","3":"0","4":"1","5":"0","_rn_":"146"},{"1":"0","2":"26.7","3":"0","4":"0","5":"0","_rn_":"147"},{"1":"1","2":"29.0","3":"0","4":"1","5":"0","_rn_":"148"},{"1":"1","2":"24.5","3":"0","4":"0","5":"1","_rn_":"149"},{"1":"1","2":"24.5","3":"0","4":"1","5":"0","_rn_":"150"},{"1":"1","2":"25.2","3":"0","4":"1","5":"0","_rn_":"151"},{"1":"1","2":"29.0","3":"0","4":"1","5":"0","_rn_":"152"},{"1":"1","2":"27.8","3":"0","4":"1","5":"0","_rn_":"153"},{"1":"1","2":"25.0","3":"0","4":"1","5":"0","_rn_":"154"},{"1":"1","2":"29.3","3":"0","4":"0","5":"0","_rn_":"155"},{"1":"1","2":"27.0","3":"0","4":"0","5":"1","_rn_":"156"},{"1":"0","2":"26.2","3":"0","4":"0","5":"1","_rn_":"157"},{"1":"0","2":"25.4","3":"0","4":"1","5":"0","_rn_":"158"},{"1":"1","2":"26.2","3":"0","4":"1","5":"0","_rn_":"159"},{"1":"0","2":"25.1","3":"0","4":"1","5":"0","_rn_":"160"},{"1":"1","2":"27.9","3":"0","4":"1","5":"0","_rn_":"161"},{"1":"1","2":"27.2","3":"0","4":"0","5":"1","_rn_":"162"},{"1":"1","2":"33.5","3":"0","4":"1","5":"0","_rn_":"163"},{"1":"0","2":"24.3","3":"0","4":"1","5":"0","_rn_":"164"},{"1":"1","2":"31.7","3":"0","4":"1","5":"0","_rn_":"165"},{"1":"1","2":"30.0","3":"0","4":"1","5":"0","_rn_":"166"},{"1":"0","2":"23.1","3":"0","4":"1","5":"0","_rn_":"167"},{"1":"1","2":"24.7","3":"0","4":"1","5":"0","_rn_":"168"},{"1":"0","2":"23.8","3":"0","4":"0","5":"1","_rn_":"169"},{"1":"1","2":"26.0","3":"0","4":"1","5":"0","_rn_":"170"},{"1":"1","2":"26.5","3":"0","4":"1","5":"0","_rn_":"171"},{"1":"1","2":"26.2","3":"0","4":"0","5":"1","_rn_":"172"},{"1":"0","2":"28.0","3":"1","4":"0","5":"0","_rn_":"173"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code># modelo completo:
fullmod &lt;- glm(data=df, y ~ ., family=binomial(link=&quot;logit&quot;))

# olhar para os AIC&#39;s mais baixos

step(fullmod) # esse jah eh o melhor no backward</code></pre>
<pre><code>## Start:  AIC=197.46
## y ~ width + Lt_Med + Medium + Dk_Med
## 
##          Df Deviance    AIC
## &lt;none&gt;        187.46 197.46
## - Lt_Med  1   190.07 198.07
## - Dk_Med  1   191.11 199.11
## - Medium  1   194.37 202.37
## - width   1   212.06 220.06</code></pre>
<pre><code>## 
## Call:  glm(formula = y ~ width + Lt_Med + Medium + Dk_Med, family = binomial(link = &quot;logit&quot;), 
##     data = df)
## 
## Coefficients:
## (Intercept)        width       Lt_Med       Medium       Dk_Med  
##     -12.715        0.468        1.330        1.402        1.106  
## 
## Degrees of Freedom: 172 Total (i.e. Null);  168 Residual
## Null Deviance:       225.8 
## Residual Deviance: 187.5     AIC: 197.5</code></pre>
<p><em>Forward</em> a partir do modelo simples:</p>
<pre class="r"><code>modmin &lt;- glm(data=df, y~1, family=binomial(link=&quot;logit&quot;))
step(modmin, direction = &quot;forward&quot;, scope = ~ width + Lt_Med + Medium + Dk_Med) #ok!</code></pre>
<pre><code>## Start:  AIC=227.76
## y ~ 1
## 
##          Df Deviance    AIC
## + width   1   194.45 198.45
## + Medium  1   219.18 223.18
## &lt;none&gt;        225.76 227.76
## + Lt_Med  1   225.06 229.06
## + Dk_Med  1   225.11 229.11
## 
## Step:  AIC=198.45
## y ~ width
## 
##          Df Deviance    AIC
## + Medium  1   191.76 197.76
## &lt;none&gt;        194.45 198.45
## + Lt_Med  1   194.37 200.37
## + Dk_Med  1   194.45 200.45
## 
## Step:  AIC=197.76
## y ~ width + Medium
## 
##          Df Deviance    AIC
## &lt;none&gt;        191.76 197.76
## + Dk_Med  1   190.07 198.07
## + Lt_Med  1   191.11 199.11</code></pre>
<pre><code>## 
## Call:  glm(formula = y ~ width + Medium, family = binomial(link = &quot;logit&quot;), 
##     data = df)
## 
## Coefficients:
## (Intercept)        width       Medium  
##    -12.1827       0.4793       0.5763  
## 
## Degrees of Freedom: 172 Total (i.e. Null);  170 Residual
## Null Deviance:       225.8 
## Residual Deviance: 191.8     AIC: 197.8</code></pre>
<p><strong>Curva ROC para os modelo selecionados:</strong></p>
<pre class="r"><code>library(pROC)</code></pre>
<pre><code>## Type &#39;citation(&quot;pROC&quot;)&#39; for a citation.</code></pre>
<pre><code>## 
## Attaching package: &#39;pROC&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     cov, smooth, var</code></pre>
<pre class="r"><code>#https://stackoverflow.com/questions/27584099/plot-multiple-roc-curves-for-logistic-regression-model-in-r



y &lt;- crabs2[[&quot;y&quot;]]

# modelo 2.2 (resultante do backward)
preds1 &lt;- predict(M2.2)
roc1=roc(y ~ preds1)

# modelo (resultante do forward)

mod_fwd &lt;- glm(data=df, y ~ width + Medium, family=binomial(link=&quot;logit&quot;))
preds2 &lt;- predict(mod_fwd)
roc2=roc(y ~ preds2)

# plot(roc1)

# help(plot.roc)

# roc1 %&gt;% 
  plotly::plot_ly(x = ~(1-roc1$specificities), y = ~roc1$sensitivities, type=&quot;scatter&quot;, mode=&quot;markers&quot;, name=&quot;ROC 1&quot;)%&gt;%
    plotly::add_trace(x = c(0, 1), y= c(0, 1), mode = &quot;lines&quot;, name=&quot;abline&quot;) %&gt;%
    plotly::add_trace(x = ~(1-roc2$specificities), y = ~roc2$sensitivities, type=&quot;scatter&quot;, mode=&quot;markers&quot;, name=&quot;ROC 2&quot;) %&gt;%
    plotly::layout(title = &quot;Curvas ROC&quot;, xaxis=list(title=&quot;1-especificidade&quot;), yaxis=list(title=&quot;sensibilidade&quot;))</code></pre>
<div id="400f6c47d7ae" style="width:864px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="400f6c47d7ae">{"x":{"visdat":{"400f69d4c051":["function () ","plotlyVisDat"]},"cur_data":"400f69d4c051","attrs":{"400f69d4c051":{"x":{},"y":{},"mode":"markers","name":"ROC 1","alpha":1,"sizes":[10,100],"type":"scatter"},"400f69d4c051.1":{"x":[0,1],"y":[0,1],"mode":"lines","name":"abline","alpha":1,"sizes":[10,100],"type":"scatter"},"400f69d4c051.2":{"x":{},"y":{},"mode":"markers","name":"ROC 2","alpha":1,"sizes":[10,100],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Curvas ROC","xaxis":{"domain":[0,1],"title":"1-especificidade"},"yaxis":{"domain":[0,1],"title":"sensibilidade"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[1,0.983870967741935,0.983870967741935,0.967741935483871,0.951612903225806,0.919354838709677,0.903225806451613,0.887096774193548,0.870967741935484,0.854838709677419,0.854838709677419,0.838709677419355,0.806451612903226,0.806451612903226,0.774193548387097,0.758064516129032,0.758064516129032,0.725806451612903,0.709677419354839,0.693548387096774,0.693548387096774,0.67741935483871,0.67741935483871,0.661290322580645,0.645161290322581,0.629032258064516,0.612903225806452,0.596774193548387,0.580645161290323,0.564516129032258,0.564516129032258,0.548387096774194,0.532258064516129,0.516129032258065,0.5,0.5,0.483870967741935,0.483870967741935,0.467741935483871,0.435483870967742,0.435483870967742,0.435483870967742,0.419354838709677,0.387096774193548,0.370967741935484,0.370967741935484,0.338709677419355,0.32258064516129,0.32258064516129,0.32258064516129,0.32258064516129,0.32258064516129,0.306451612903226,0.306451612903226,0.290322580645161,0.274193548387097,0.258064516129032,0.193548387096774,0.193548387096774,0.193548387096774,0.193548387096774,0.193548387096774,0.193548387096774,0.161290322580645,0.161290322580645,0.161290322580645,0.145161290322581,0.145161290322581,0.129032258064516,0.112903225806452,0.112903225806452,0.112903225806452,0.112903225806452,0.0806451612903226,0.0806451612903226,0.0806451612903226,0.0806451612903226,0.0806451612903226,0.0806451612903226,0.0806451612903226,0.0806451612903226,0.0806451612903226,0.0806451612903226,0.0806451612903226,0.0806451612903226,0.0645161290322581,0.0483870967741935,0.0483870967741935,0.0483870967741935,0.0483870967741935,0.0483870967741935,0.0483870967741935,0.032258064516129,0.032258064516129,0.032258064516129,0.0161290322580645,0,0,0,0,0,0,0,0,0,0,0,0,0],"y":[1,1,0.990990990990991,0.990990990990991,0.990990990990991,0.990990990990991,0.990990990990991,0.990990990990991,0.981981981981982,0.981981981981982,0.972972972972973,0.963963963963964,0.963963963963964,0.954954954954955,0.954954954954955,0.954954954954955,0.936936936936937,0.927927927927928,0.927927927927928,0.918918918918919,0.90990990990991,0.90990990990991,0.900900900900901,0.900900900900901,0.900900900900901,0.900900900900901,0.900900900900901,0.900900900900901,0.900900900900901,0.882882882882883,0.873873873873874,0.873873873873874,0.864864864864865,0.864864864864865,0.864864864864865,0.855855855855856,0.855855855855856,0.846846846846847,0.837837837837838,0.837837837837838,0.81981981981982,0.810810810810811,0.810810810810811,0.801801801801802,0.792792792792793,0.756756756756757,0.756756756756757,0.747747747747748,0.72972972972973,0.720720720720721,0.711711711711712,0.693693693693694,0.675675675675676,0.666666666666667,0.648648648648649,0.648648648648649,0.630630630630631,0.630630630630631,0.621621621621622,0.612612612612613,0.603603603603604,0.576576576576577,0.567567567567568,0.54954954954955,0.540540540540541,0.531531531531532,0.531531531531532,0.513513513513513,0.513513513513513,0.486486486486487,0.477477477477477,0.468468468468468,0.459459459459459,0.45045045045045,0.441441441441441,0.432432432432432,0.423423423423423,0.414414414414414,0.405405405405405,0.387387387387387,0.36036036036036,0.351351351351351,0.342342342342342,0.333333333333333,0.324324324324324,0.315315315315315,0.315315315315315,0.297297297297297,0.279279279279279,0.261261261261261,0.225225225225225,0.216216216216216,0.198198198198198,0.18018018018018,0.171171171171171,0.162162162162162,0.153153153153153,0.117117117117117,0.108108108108108,0.0990990990990991,0.0900900900900901,0.0810810810810811,0.0540540540540541,0.045045045045045,0.036036036036036,0.027027027027027,0.018018018018018,0.00900900900900901,0],"mode":"markers","name":"ROC 1","type":"scatter","marker":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y","frame":null},{"x":[0,1],"y":[0,1],"mode":"lines","name":"abline","type":"scatter","line":{"fillcolor":"rgba(255,127,14,1)","color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,0.983870967741935,0.967741935483871,0.951612903225806,0.935483870967742,0.903225806451613,0.887096774193548,0.870967741935484,0.838709677419355,0.838709677419355,0.82258064516129,0.82258064516129,0.806451612903226,0.774193548387097,0.758064516129032,0.741935483870968,0.725806451612903,0.725806451612903,0.693548387096774,0.661290322580645,0.645161290322581,0.629032258064516,0.629032258064516,0.612903225806452,0.612903225806452,0.596774193548387,0.596774193548387,0.548387096774194,0.532258064516129,0.516129032258065,0.467741935483871,0.451612903225806,0.435483870967742,0.435483870967742,0.435483870967742,0.435483870967742,0.435483870967742,0.403225806451613,0.370967741935484,0.370967741935484,0.354838709677419,0.354838709677419,0.338709677419355,0.338709677419355,0.32258064516129,0.306451612903226,0.290322580645161,0.274193548387097,0.209677419354839,0.193548387096774,0.193548387096774,0.193548387096774,0.193548387096774,0.193548387096774,0.161290322580645,0.129032258064516,0.129032258064516,0.129032258064516,0.112903225806452,0.112903225806452,0.0967741935483871,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0483870967741935,0.0483870967741935,0.0483870967741935,0.0483870967741935,0.0483870967741935,0.032258064516129,0.032258064516129,0.0161290322580645,0.0161290322580645,0,0,0,0,0,0,0,0,0,0,0],"y":[1,1,1,0.990990990990991,0.981981981981982,0.981981981981982,0.981981981981982,0.981981981981982,0.981981981981982,0.972972972972973,0.963963963963964,0.954954954954955,0.954954954954955,0.945945945945946,0.945945945945946,0.945945945945946,0.945945945945946,0.936936936936937,0.90990990990991,0.900900900900901,0.900900900900901,0.900900900900901,0.882882882882883,0.882882882882883,0.873873873873874,0.873873873873874,0.864864864864865,0.864864864864865,0.864864864864865,0.855855855855856,0.855855855855856,0.846846846846847,0.828828828828829,0.81981981981982,0.801801801801802,0.774774774774775,0.756756756756757,0.747747747747748,0.72972972972973,0.693693693693694,0.684684684684685,0.666666666666667,0.657657657657658,0.648648648648649,0.630630630630631,0.621621621621622,0.603603603603604,0.576576576576577,0.576576576576577,0.567567567567568,0.558558558558559,0.531531531531532,0.522522522522523,0.513513513513513,0.495495495495495,0.486486486486487,0.477477477477477,0.468468468468468,0.441441441441441,0.432432432432432,0.432432432432432,0.423423423423423,0.414414414414414,0.405405405405405,0.396396396396396,0.378378378378378,0.36036036036036,0.333333333333333,0.324324324324324,0.315315315315315,0.306306306306306,0.288288288288288,0.279279279279279,0.261261261261261,0.243243243243243,0.225225225225225,0.189189189189189,0.171171171171171,0.162162162162162,0.153153153153153,0.144144144144144,0.135135135135135,0.126126126126126,0.0900900900900901,0.0810810810810811,0.0720720720720721,0.045045045045045,0.036036036036036,0.027027027027027,0.018018018018018,0.00900900900900901,0],"mode":"markers","name":"ROC 2","type":"scatter","marker":{"fillcolor":"rgba(44,160,44,1)","color":"rgba(44,160,44,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<hr />
<hr />
<hr />
</div>
</div>
<div id="referencias-bibliograficas" class="section level3">
<h3>Referências Bibliográficas</h3>
<hr />
<p>AGRESTI, ALAN. <em>An Introduction to Categorical Data Analysis</em>. John Wiley &amp; Sons, second edition, 2007.</p>
<p>NOTAS DE AULA. <em>Análise de Dados Categorizados</em>. Curso de Graduação em Estatística, UnB, 2018.</p>
<p>R CORE TEAM. <em>R: A language and environment for statistical computing</em>. R Foundation for Statistical Computing, Vienna, Austria. URL <a href="https://www.R-project.org/" class="uri">https://www.R-project.org/</a>.</p>
<hr />
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
