<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Allan Vieira 14/0128492" />
<meta name="author" content="Caio Balena" />
<meta name="author" content="Frederico Lucca" />
<meta name="author" content="José Cezário" />

<meta name="date" content="2018-06-22" />

<title>Beetles</title>

<script src="beetles_new_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="beetles_new_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="beetles_new_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="beetles_new_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="beetles_new_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="beetles_new_files/navigation-1.1/tabsets.js"></script>
<script src="beetles_new_files/navigation-1.1/codefolding.js"></script>
<link href="beetles_new_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="beetles_new_files/highlightjs-9.12.0/highlight.js"></script>
<link href="beetles_new_files/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="beetles_new_files/pagedtable-1.1/js/pagedtable.js"></script>
<script src="beetles_new_files/htmlwidgets-1.0/htmlwidgets.js"></script>
<script src="beetles_new_files/plotly-binding-4.7.1/plotly.js"></script>
<script src="beetles_new_files/typedarray-0.1/typedarray.min.js"></script>
<link href="beetles_new_files/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="beetles_new_files/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="beetles_new_files/plotlyjs-1.29.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="beetles_new_files/plotlyjs-1.29.2/plotly-latest.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>



<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>






<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore"><strong>Beetles</strong></h1>
<h3 class="subtitle"><em>Regressão Logística - Análise de Dados Categorizados - Prova 3</em></h3>
<h4 class="author"><em>Allan Vieira 14/0128492</em></h4>
<h4 class="author"><em>Caio Balena</em></h4>
<h4 class="author"><em>Frederico Lucca</em></h4>
<h4 class="author"><em>José Cezário</em></h4>
<h4 class="date"><em>22 June 2018</em></h4>

</div>


<!-- self_contained: false --- para nao dar pau do plotly com firefox -->
<!-- df_print para as formas de imprimir data frames e tibbles -->
<!-- ver https://rmarkdown.rstudio.com/html_document_format.html -->
<!-- incluir no cabecalho: -->
<!-- always_allow_html: yes  -->
<!--para quando formos passar para pdf -->
<style>
body {
text-align: justify}
</style>
<!-- para justificar texto no markdown -->
<!-- https://stackoverflow.com/questions/43222169/how-to-justify-the-text-to-both-sides-when-knitting-html-in-rmarkdown -->
<!-- <style> -->
<!--   .col2 { -->
<!--     columns: 2 200px;         /* number of columns and width in pixels*/ -->
<!--     -webkit-columns: 2 200px; /* chrome, safari */ -->
<!--     -moz-columns: 2 200px;    /* firefox */ -->
<!--   } -->
<!--   .col3 { -->
<!--     columns: 3 100px; -->
<!--     -webkit-columns: 3 100px; -->
<!--     -moz-columns: 3 100px; -->
<!--   } -->
<!-- </style> -->
<!-- esse de cima funciona no output do RStudio, mas nao nos browsers -->
<!-- tb em: https://stackoverflow.com/questions/31753897/2-column-section-in-r-markdown -->
<!-- para acrescentar logo da unb no cabeçalho -->
<script>
   $(document).ready(function() {
     $head = $('#header');
     $head.prepend('<img src=\"unb3.png\" style=\"float: right;width: 150px;\"/>')
   });
</script>
<hr />
<hr />
<!-- ```{r, echo=FALSE} -->
<!-- htmltools::img(src = knitr::image_uri(file.path(R.home("doc"), "html", "logo.jpg")),  -->
<!--                alt = 'logo',  -->
<!--                style = 'position:absolute; top:0; right:0; padding:1px;') -->
<!-- ``` -->
<p><strong>Carregamento de pacotes:</strong></p>
<p>Neste exemplo são utilizados os seguintes pacotes: <em>dplyr</em>, <em>magrittr</em>, <em>tibble</em>, <em>plotly</em>, <em>lmtest</em>, <em>ResouceSelection</em> e <em>modEvA</em>. Para a confecção do documento html, é necessário o pacote <em>rmarkdown</em>.</p>
<pre class="r"><code># dplyr -- para facilitar manipulacao de dados
if (!require(&#39;dplyr&#39;)) install.packages(&#39;dplyr&#39;); library(&#39;dplyr&#39;)

# magrittr -- para facilitar manipulacao de dados
if (!require(&#39;magrittr&#39;)) install.packages(&#39;magrittr&#39;); library(&#39;magrittr&#39;)

# tibble -- para facilitar manipulacao de dados
if (!require(&#39;tibble&#39;)) install.packages(&#39;tibble&#39;); library(&#39;tibble&#39;)

# broom -- para facilitar manipulacao de dados
if (!require(&#39;broom&#39;)) install.packages(&#39;broom&#39;); library(&#39;broom&#39;)

# plotly -- para os plots
if (!require(&#39;plotly&#39;)) install.packages(&#39;plotly&#39;); library(&#39;plotly&#39;)

# lmtest -- para os testes de razao de verossimilhancas e para o teste de wald
if (!require(&#39;lmtest&#39;)) install.packages(&#39;lmtest&#39;); library(&#39;lmtest&#39;)

# ResourceSelection -- para utilizar uma versão do teste de Hosmer Lemeshow
if (!require(&#39;ResourceSelection&#39;)) install.packages(&#39;ResourceSelection&#39;); library(&#39;ResourceSelection&#39;)

# modEVA -- para compelemntar a funcao alternativa do teste de Hosmer Lemeshow
if (!require(&#39;modEvA&#39;)) install.packages(&#39;modEvA&#39;); library(&#39;modEvA&#39;)</code></pre>
<p></p>
<p><strong>Carregamento dos dados</strong>:</p>
<pre class="r"><code>dose &lt;- c(1.6907, 1.7242, 1.7552, 1.7842, 1.8113, 1.8369, 1.8610, 1.8839)

killed &lt;- c(6, 13, 18, 28, 52, 53, 61, 59)

total &lt;- c(59, 60, 62, 56, 63, 59, 62, 60)

# criando uma coluna do outro resultado: x = 1 (survived); x = 0 (killed)
beetles &lt;- tibble::data_frame(dose, killed, total) %&gt;%
  dplyr::mutate(survived = total - killed, prop = killed/total)

beetles</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["dose"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["killed"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["total"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["survived"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["prop"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"1.6907","2":"6","3":"59","4":"53","5":"0.1016949"},{"1":"1.7242","2":"13","3":"60","4":"47","5":"0.2166667"},{"1":"1.7552","2":"18","3":"62","4":"44","5":"0.2903226"},{"1":"1.7842","2":"28","3":"56","4":"28","5":"0.5000000"},{"1":"1.8113","2":"52","3":"63","4":"11","5":"0.8253968"},{"1":"1.8369","2":"53","3":"59","4":"6","5":"0.8983051"},{"1":"1.8610","2":"61","3":"62","4":"1","5":"0.9838710"},{"1":"1.8839","2":"59","3":"60","4":"1","5":"0.9833333"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p></p>
<p><strong>Plot:</strong></p>
<pre class="r"><code>beetles %&gt;%
  #dplyr::mutate(color = factor(falhas)) %&gt;%
  
  plotly::plot_ly(x=~dose, y=~prop, #group=~color,
                           type=&quot;scatter&quot;, mode=&quot;markers&quot; #, color=~color, #split=~falhas
          ) %&gt;%
  plotly::layout(title = &quot;Beetle Mortality Data&quot;)</code></pre>
<div id="38fa1fe32125" style="width:864px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="38fa1fe32125">{"x":{"visdat":{"38fa37aa2cb0":["function () ","plotlyVisDat"]},"cur_data":"38fa37aa2cb0","attrs":{"38fa37aa2cb0":{"x":{},"y":{},"mode":"markers","alpha":1,"sizes":[10,100],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Beetle Mortality Data","xaxis":{"domain":[0,1],"title":"dose"},"yaxis":{"domain":[0,1],"title":"prop"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[1.6907,1.7242,1.7552,1.7842,1.8113,1.8369,1.861,1.8839],"y":[0.101694915254237,0.216666666666667,0.290322580645161,0.5,0.825396825396825,0.898305084745763,0.983870967741935,0.983333333333333],"mode":"markers","type":"scatter","marker":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<p></p>
<p><strong>Ajuste do modelo</strong>:</p>
<pre class="r"><code>resp &lt;- as.matrix(
  beetles %&gt;%
  dplyr::select(killed, survived)
)

fit &lt;- glm(resp ~ dose, family=binomial(link=&quot;logit&quot;))

summary(fit)</code></pre>
<pre><code>## 
## Call:
## glm(formula = resp ~ dose, family = binomial(link = &quot;logit&quot;))
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.5139  -0.2808   0.5536   1.0175   1.3788  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  -59.188      5.053  -11.71   &lt;2e-16 ***
## dose          33.401      2.839   11.76   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 274.8744  on 7  degrees of freedom
## Residual deviance:   8.6398  on 6  degrees of freedom
## AIC: 40.821
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p></p>
<p></p>
<p><strong>-2logLik:</strong></p>
<p></p>
<pre class="r"><code># -2logLik
-2*logLik(fit)</code></pre>
<pre><code>## &#39;log Lik.&#39; 36.82103 (df=2)</code></pre>
<p></p>
<p><strong>Int. Conf. OR:</strong></p>
<pre class="r"><code># OR
exp(confint.default(fit)) # o metodo *.default* assume normalidade assintotica, por isso eh utilizado.</code></pre>
<pre><code>##                    2.5 %       97.5 %
## (Intercept) 9.864035e-31 3.947270e-22
## dose        1.226916e+12 8.368858e+16</code></pre>
<p></p>
<p><strong>Teste de Razão de Verossimilhanças:</strong></p>
<pre class="r"><code># 1) razao de verossimilhancas
#library(lmtest)
lmtest::lrtest(fit)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["#Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["LogLik"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Chisq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chisq)"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"2","2":"-18.41052","3":"NA","4":"NA","5":"NA","_rn_":"1"},{"1":"1","2":"-151.52785","3":"-1","4":"266.2347","5":"7.508746e-60","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p></p>
<p><strong>Teste de Wald:</strong></p>
<pre class="r"><code># 2) teste de Wald
lmtest::waldtest(fit)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Res.Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["F"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"6","2":"NA","3":"NA","4":"NA","_rn_":"1"},{"1":"7","2":"-1","3":"138.3724","4":"2.27897e-05","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p></p>
<p><strong>Teste Score:</strong></p>
<pre class="r"><code># 3) Score
anova(fit,test=&quot;Rao&quot;)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["Deviance"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Resid. Df"],"name":[3],"type":["int"],"align":["right"]},{"label":["Resid. Dev"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Rao"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"NA","2":"NA","3":"7","4":"274.874424","5":"NA","6":"NA","_rn_":"NULL"},{"1":"1","2":"266.2347","3":"6","4":"8.639754","5":"223.1746","6":"1.836285e-50","_rn_":"dose"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p></p>
<p></p>
<p></p>
<p><strong>Teste de Hosmer Lemeshow:</strong></p>
<p>No <strong>R</strong>, há métodos diferentes que implementam o teste de Hosmer Lemeshow. Abaixo, são apresentadas duas formas.</p>
<p>A primeira delas seria utilizando o modelo a partir do qual os dados foram ajustados na forma de tabela de frequências. Mas como nesse caso só há 8 observações, deve-se ajustar o parâmetro <code>g</code> (número de classes/intervalos) da função para um valor menor.</p>
<pre class="r"><code>ResourceSelection::hoslem.test(fit$y, fit$fitted.values, g=5)</code></pre>
<pre><code>## 
##  Hosmer and Lemeshow goodness of fit (GOF) test
## 
## data:  fit$y, fit$fitted.values
## X-squared = 0.092295, df = 3, p-value = 0.9927</code></pre>
<p></p>
<p>A segunda forma é ajustando um novo modelo com base nos dados expandidos com a variável resposta na forma de zeros e uns (0,1). Assim ganham-se graus de liberdade e, consequentemente mais “espaço” para os intervalos. Note que na saída do modelo, tem-se exatamente os mesmos valores de coeficientes e de p-valor, mas valores diferentes para AIC, <em>deviance</em> etc. Essa diferença deve-se justamente ao maior número de observações que se tem agora. Na verdade, com essa configuração de dados, todas as sapidas (AIC, etc) passam a bater exatamente com as saídas do SAS.</p>
<pre class="r"><code>beetles2 &lt;- as.data.frame(beetles)

# antes do teste, eh necessario transformar para zero e uns
# o nao evento eh sobreviver
response_l &lt;- lapply(1:nrow(beetles2), function(i){
  killed &lt;- rep(c(0,1), c(beetles2[i,&quot;survived&quot;], beetles2[i,&quot;killed&quot;])) # response
  dose &lt;- rep(beetles2[i,&quot;dose&quot;], length(killed)) # variable
  cbind(dose, killed)
})

beetles_newdata &lt;- as.data.frame(Reduce(rbind, response_l))

fit2 &lt;- glm(killed ~ dose, data=beetles_newdata, family=binomial(link=&quot;logit&quot;))

summary(fit2) # os deviance, df e AIC diferentes enm relacao ao modelo 1 vem devido ao nro de linhas (obs) no modelo expandido</code></pre>
<pre><code>## 
## Call:
## glm(formula = killed ~ dose, family = binomial(link = &quot;logit&quot;), 
##     data = beetles_newdata)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.7421  -0.6070   0.2171   0.4658   2.3584  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  -59.188      5.053  -11.71   &lt;2e-16 ***
## dose          33.401      2.839   11.76   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 646.28  on 480  degrees of freedom
## Residual deviance: 380.05  on 479  degrees of freedom
## AIC: 384.05
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p></p>
<p>Para o teste, foi feita uma pequena aleração na função <em>HLfit()</em> do pacote <strong>modEvA</strong>. O objetivo é replicar os resultados apresentados no output do <strong>SAS</strong> para o teste de <em>Hosmer Lemeshow</em>. Os ajustes são para solucionar um <em>bug</em> da função e para fazer com que ela retorne também uma tabela das partições que foram geradas para o teste. Esta função é a única que tem retorno parecido com o do SAS porque permite escolher métodos diferentes para gerar os intervalos nos dados. No caso utilizamos <code>bin.method=&quot;quantile&quot;</code>.</p>
<pre class="r"><code># library(modEvA)
# alteração da função HLfit:
HLfit2 &lt;- function (model = NULL, obs = NULL, pred = NULL, bin.method, n.bins = 10, fixed.bin.size = FALSE, min.bin.size = 15, min.prob.interval = 0.1, simplif = FALSE) {
  # version 1.5 (24 Jun 2015)
  
  if (!is.null(model)) {
    if (!is.null(obs)) message(&quot;Argument &#39;obs&#39; ignored in favour of &#39;model&#39;.&quot;)
    if (!is.null(pred)) message(&quot;Argument &#39;pred&#39; ignored in favour of &#39;model&#39;.&quot;)
    obs &lt;- model$y
    pred &lt;- model$fitted.values
  }
  
  stopifnot(
    length(obs) == length(pred),
    obs %in% c(0, 1),
    pred &gt;= 0,
    pred &lt;= 1
  )
  
  bins &lt;- getBins(obs = obs, pred = pred, bin.method = bin.method, n.bins = n.bins, fixed.bin.size = fixed.bin.size, min.bin.size = min.bin.size, min.prob.interval = min.prob.interval)
  n.bins &lt;- nrow(bins$bins.table)
  
  # next 4 lines: adapted from hosmerlem function in http://www.stat.sc.edu/~hitchcock/diseaseoutbreakRexample704.txt
  observed &lt;- xtabs(cbind(1 - obs, obs) ~ bins$prob.bin)
  expected &lt;- xtabs(cbind(1 - pred, pred) ~ bins$prob.bin)
  chi.sq &lt;- sum((observed - expected) ^ 2 / expected)
  p.value &lt;- 1 - pchisq(chi.sq, df = n.bins - 2)
  rmse &lt;- sqrt(mean((observed - expected) ^ 2))
  
  if (simplif) return(list(chi.sq = chi.sq, p.value = p.value, RMSE = rmse))
  
  # retiramos plot -- nosso ajuste!
  
  # nosso ajuste: partition table
  partition &lt;- data.frame(cbind(matrix(observed[,2]), matrix(expected[,2])), 
                          cbind(matrix(observed[,1]), matrix(expected[,1])))
  
  colnames(partition) &lt;- c(&quot;Observed_Event&quot;, &quot;Expected_Event&quot;, &quot;Observed_Nonevent&quot;, &quot;Expected_Nonevent&quot;)
  
  return(list(partition = partition, stats = list(chi.sq = chi.sq, DF = n.bins - 2, p.value = p.value), RMSE = rmse))
}</code></pre>
<pre class="r"><code>out_HL &lt;- HLfit2(model=fit2, bin.method = &quot;quantiles&quot;, n.bins = 10) # ok!

tibble::as.tibble(out_HL$partition)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Observed_Event"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Expected_Event"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Observed_Nonevent"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Expected_Nonevent"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"6","2":"3.656756","3":"53","4":"55.343244"},{"1":"13","2":"10.095220","3":"47","4":"49.904780"},{"1":"18","2":"22.502185","3":"44","4":"39.497815"},{"1":"28","2":"33.607019","3":"28","4":"22.392981"},{"1":"52","2":"49.625411","3":"11","4":"13.374589"},{"1":"53","2":"52.933227","3":"6","4":"6.066773"},{"1":"61","2":"58.977758","3":"1","4":"3.022242"},{"1":"59","2":"58.602425","3":"1","4":"1.397575"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>out_HL$stats</code></pre>
<pre><code>## $chi.sq
## [1] 8.433355
## 
## $DF
## [1] 6
## 
## $p.value
## [1] 0.2080418</code></pre>
<p></p>
<p><strong>Ajustes pré-plotagem:</strong></p>
<pre class="r"><code># criando obs artificiais para suavizar a curva
x_limits &lt;- beetles %&gt;%
  dplyr::summarise(min = min(dose), max = max(dose)) # obtendo os limites do eixo x

x &lt;- seq(x_limits[[1]], x_limits[[2]], by=0.001) # criando varios ptos entre esses limites -- by precisa ser bem pequeno aqui

# obtendo os valores de y de acordo com os parametros da reg logist
y &lt;- plogis(fit$coefficients[1]+fit$coefficients[2]*x)


# fazendo a predicao das obs artificiais
# ver sol: https://stackoverflow.com/questions/26694931/how-to-plot-logit-and-probit-in-ggplot2
temp.data = data.frame(dose = x) # se nao passar a coluna com o mesmo nome da variavel nao funciona


# Predict the fitted values given the model and hypothetical data
predicted.data &lt;- as.data.frame(predict(fit, newdata = temp.data, 
                                        type=&quot;link&quot;, se=TRUE))

# Combine the hypothetical data and predicted values
new.data &lt;- cbind(temp.data, predicted.data)

# Calculate confidence intervals
std &lt;- qnorm(0.95 / 2 + 0.5)
new.data$ymin &lt;- fit$family$linkinv(new.data$fit - std * new.data$se)
new.data$ymax &lt;- fit$family$linkinv(new.data$fit + std * new.data$se)
new.data$fit &lt;- fit$family$linkinv(new.data$fit)  # Rescale to 0-1</code></pre>
<p></p>
<p><strong>Plot:</strong></p>
<pre class="r"><code>plotly::plot_ly(x = ~x, y = ~y, name = &#39;fitted&#39;, type = &#39;scatter&#39;, mode = &#39;lines&#39;) %&gt;%
  plotly::add_trace(x= ~dose, y = ~prop, name = &#39;resp&#39;, mode = &#39;markers&#39;, data=beetles) %&gt;%
  plotly::add_ribbons(data = new.data,
              ymin = ~ymin,
              ymax = ~ymax,
              line = list(color = &#39;rgba(138,43,226, 0.05)&#39;, opacity = 0.1),
              fillcolor = &#39;rgba(138,43,226, 0.2)&#39;, opacity = 0.25,
              name = &quot;95% conf.&quot;) %&gt;%
  plotly::layout(title = &quot;Beetle Mortality Data&quot;)</code></pre>
<div id="38fa2ccc30b4" style="width:864px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="38fa2ccc30b4">{"x":{"visdat":{"38fa317fcdb9":["function () ","plotlyVisDat"],"38fa5b27b7db":["function () ","data"],"38fa310ffff0":["function () ","data"]},"cur_data":"38fa310ffff0","attrs":{"38fa317fcdb9":{"x":{},"y":{},"name":"fitted","mode":"lines","alpha":1,"sizes":[10,100],"type":"scatter"},"38fa5b27b7db":{"x":{},"y":{},"name":"resp","mode":"markers","alpha":1,"sizes":[10,100],"type":"scatter"},"38fa310ffff0":{"x":{},"y":{},"name":"95% conf.","mode":"lines","alpha":1,"sizes":[10,100],"type":"scatter","ymin":{},"ymax":{},"hoveron":"points","fill":"toself","line":{"color":"rgba(138,43,226, 0.05)","opacity":0.1},"fillcolor":"rgba(138,43,226, 0.2)","opacity":0.25}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Beetle Mortality Data","xaxis":{"domain":[0,1],"title":"x"},"yaxis":{"domain":[0,1],"title":"y"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[1.6907,1.6917,1.6927,1.6937,1.6947,1.6957,1.6967,1.6977,1.6987,1.6997,1.7007,1.7017,1.7027,1.7037,1.7047,1.7057,1.7067,1.7077,1.7087,1.7097,1.7107,1.7117,1.7127,1.7137,1.7147,1.7157,1.7167,1.7177,1.7187,1.7197,1.7207,1.7217,1.7227,1.7237,1.7247,1.7257,1.7267,1.7277,1.7287,1.7297,1.7307,1.7317,1.7327,1.7337,1.7347,1.7357,1.7367,1.7377,1.7387,1.7397,1.7407,1.7417,1.7427,1.7437,1.7447,1.7457,1.7467,1.7477,1.7487,1.7497,1.7507,1.7517,1.7527,1.7537,1.7547,1.7557,1.7567,1.7577,1.7587,1.7597,1.7607,1.7617,1.7627,1.7637,1.7647,1.7657,1.7667,1.7677,1.7687,1.7697,1.7707,1.7717,1.7727,1.7737,1.7747,1.7757,1.7767,1.7777,1.7787,1.7797,1.7807,1.7817,1.7827,1.7837,1.7847,1.7857,1.7867,1.7877,1.7887,1.7897,1.7907,1.7917,1.7927,1.7937,1.7947,1.7957,1.7967,1.7977,1.7987,1.7997,1.8007,1.8017,1.8027,1.8037,1.8047,1.8057,1.8067,1.8077,1.8087,1.8097,1.8107,1.8117,1.8127,1.8137,1.8147,1.8157,1.8167,1.8177,1.8187,1.8197,1.8207,1.8217,1.8227,1.8237,1.8247,1.8257,1.8267,1.8277,1.8287,1.8297,1.8307,1.8317,1.8327,1.8337,1.8347,1.8357,1.8367,1.8377,1.8387,1.8397,1.8407,1.8417,1.8427,1.8437,1.8447,1.8457,1.8467,1.8477,1.8487,1.8497,1.8507,1.8517,1.8527,1.8537,1.8547,1.8557,1.8567,1.8577,1.8587,1.8597,1.8607,1.8617,1.8627,1.8637,1.8647,1.8657,1.8667,1.8677,1.8687,1.8697,1.8707,1.8717,1.8727,1.8737,1.8747,1.8757,1.8767,1.8777,1.8787,1.8797,1.8807,1.8817,1.8827,1.8837],"y":[0.0619789114524398,0.0639493909830694,0.0659781110275411,0.0680665098973969,0.0702160432308911,0.0724281829352419,0.0747044160256148,0.0770462433563686,0.0794551782401621,0.0819327449505596,0.084480477103885,0.0870999159161764,0.0897926083312797,0.0925601050162749,0.0954039582207106,0.0983257194963393,0.101326937274425,0.104409154298005,0.107573904906953,0.110822712174115,0.114157084891341,0.117578514404789,0.121088471299534,0.124688401934176,0.128379724826924,0.132163826895425,0.136042059553471,0.140015734668662,0.144086120386087,0.148254436824104,0.152521851649445,0.156889475539947,0.16135835754447,0.165929480350737,0.170603755473139,0.175382018373801,0.180265023531532,0.185253439474593,0.190347843794555,0.195548718159756,0.200856443348259,0.206271294321308,0.21179343535962,0.217422915285833,0.223159662797587,0.229003481936584,0.234954047719826,0.241010901959924,0.247173449301959,0.253440953504667,0.259812533994086,0.266287162717639,0.272863661326607,0.279540698714403,0.28631678893751,0.293190289545017,0.300159400341578,0.307222162607229,0.314376458795903,0.321620012732533,0.328950390326588,0.33636500081743,0.343861098564335,0.35143578539117,0.35908601349272,0.366808588906408,0.374600175549899,0.382457299821434,0.390376355756339,0.398353610729325,0.40638521168866,0.414467191904489,0.422595478210028,0.430765898710702,0.43897419093295,0.447216010380997,0.455486939466935,0.463782496776406,0.472098146629735,0.480429308895859,0.488771369014545,0.497119688180602,0.505469613642552,0.513816489067266,0.522155664921577,0.530482508821671,0.538792415801436,0.547080818451449,0.55534319688149,0.563575088460755,0.571772097291811,0.579929903376405,0.588044271433662,0.596111059333916,0.604126226114412,0.612085839546187,0.619986083224931,0.627823263161961,0.635593813855181,0.643294303823445,0.650921440591519,0.658472075116454,0.66594320564986,0.673331981034085,0.680635703433818,0.687851830507854,0.694977977029024,0.702011915963111,0.708951579020481,0.715795056696551,0.722540597819638,0.72918660862667,0.735731651389179,0.742174442613391,0.748513850839692,0.754748894067649,0.760878736833684,0.766902686969,0.772820192065721,0.778630835679321,0.784334333295364,0.789930528088261,0.79541938649938,0.800800993661163,0.806075548693222,0.811243359895513,0.816304839862683,0.82126050054265,0.826110948261301,0.830856878734025,0.835499072083504,0.840038387881917,0.844475760234413,0.848812192919366,0.853048754599639,0.857186574117755,0.861226835886596,0.865170775386033,0.869019674774607,0.872774858624258,0.876437689784952,0.880009565384967,0.883491912971601,0.886886186796055,0.890193864245372,0.893416442423443,0.89655543488231,0.899612368504236,0.902588780534379,0.90548621576327,0.908306223857725,0.911050356838341,0.913720166701267,0.916317203181538,0.918843011654899,0.921299131174771,0.923687092640719,0.926008417094573,0.928264614140174,0.930457180482576,0.932587598582391,0.934657335420922,0.936667841371649,0.938620549173604,0.940516873002177,0.942358207632899,0.944145927693772,0.945881387001808,0.947565917979432,0.949200831146569,0.950787414684227,0.952326934065589,0.953820631750633,0.955269726940504,0.956675415387896,0.958038869259905,0.959361237049865,0.960643643534877,0.961887189775816,0.963092953156755,0.964261987460893,0.965395322980161,0.966493966655846,0.967558902247696,0.968591090529059,0.969591469505786,0.970560954656702,0.971500439193589,0.972410794338733,0.973292869618192,0.974147493169061,0.974975472059097,0.975777592617175,0.976554620773147],"name":"fitted","mode":"lines","type":"scatter","line":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1.6907,1.7242,1.7552,1.7842,1.8113,1.8369,1.861,1.8839],"y":[0.101694915254237,0.216666666666667,0.290322580645161,0.5,0.825396825396825,0.898305084745763,0.983870967741935,0.983333333333333],"name":"resp","mode":"markers","type":"scatter","marker":{"fillcolor":"rgba(255,127,14,1)","color":"rgba(255,127,14,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y","frame":null},{"x":[1.6907,1.6917,1.6927,1.6937,1.6947,1.6957,1.6967,1.6977,1.6987,1.6997,1.7007,1.7017,1.7027,1.7037,1.7047,1.7057,1.7067,1.7077,1.7087,1.7097,1.7107,1.7117,1.7127,1.7137,1.7147,1.7157,1.7167,1.7177,1.7187,1.7197,1.7207,1.7217,1.7227,1.7237,1.7247,1.7257,1.7267,1.7277,1.7287,1.7297,1.7307,1.7317,1.7327,1.7337,1.7347,1.7357,1.7367,1.7377,1.7387,1.7397,1.7407,1.7417,1.7427,1.7437,1.7447,1.7457,1.7467,1.7477,1.7487,1.7497,1.7507,1.7517,1.7527,1.7537,1.7547,1.7557,1.7567,1.7577,1.7587,1.7597,1.7607,1.7617,1.7627,1.7637,1.7647,1.7657,1.7667,1.7677,1.7687,1.7697,1.7707,1.7717,1.7727,1.7737,1.7747,1.7757,1.7767,1.7777,1.7787,1.7797,1.7807,1.7817,1.7827,1.7837,1.7847,1.7857,1.7867,1.7877,1.7887,1.7897,1.7907,1.7917,1.7927,1.7937,1.7947,1.7957,1.7967,1.7977,1.7987,1.7997,1.8007,1.8017,1.8027,1.8037,1.8047,1.8057,1.8067,1.8077,1.8087,1.8097,1.8107,1.8117,1.8127,1.8137,1.8147,1.8157,1.8167,1.8177,1.8187,1.8197,1.8207,1.8217,1.8227,1.8237,1.8247,1.8257,1.8267,1.8277,1.8287,1.8297,1.8307,1.8317,1.8327,1.8337,1.8347,1.8357,1.8367,1.8377,1.8387,1.8397,1.8407,1.8417,1.8427,1.8437,1.8447,1.8457,1.8467,1.8477,1.8487,1.8497,1.8507,1.8517,1.8527,1.8537,1.8547,1.8557,1.8567,1.8577,1.8587,1.8597,1.8607,1.8617,1.8627,1.8637,1.8647,1.8657,1.8667,1.8677,1.8687,1.8697,1.8707,1.8717,1.8727,1.8737,1.8747,1.8757,1.8767,1.8777,1.8787,1.8797,1.8807,1.8817,1.8827,1.8837,1.8837,1.8837,1.8827,1.8817,1.8807,1.8797,1.8787,1.8777,1.8767,1.8757,1.8747,1.8737,1.8727,1.8717,1.8707,1.8697,1.8687,1.8677,1.8667,1.8657,1.8647,1.8637,1.8627,1.8617,1.8607,1.8597,1.8587,1.8577,1.8567,1.8557,1.8547,1.8537,1.8527,1.8517,1.8507,1.8497,1.8487,1.8477,1.8467,1.8457,1.8447,1.8437,1.8427,1.8417,1.8407,1.8397,1.8387,1.8377,1.8367,1.8357,1.8347,1.8337,1.8327,1.8317,1.8307,1.8297,1.8287,1.8277,1.8267,1.8257,1.8247,1.8237,1.8227,1.8217,1.8207,1.8197,1.8187,1.8177,1.8167,1.8157,1.8147,1.8137,1.8127,1.8117,1.8107,1.8097,1.8087,1.8077,1.8067,1.8057,1.8047,1.8037,1.8027,1.8017,1.8007,1.7997,1.7987,1.7977,1.7967,1.7957,1.7947,1.7937,1.7927,1.7917,1.7907,1.7897,1.7887,1.7877,1.7867,1.7857,1.7847,1.7837,1.7827,1.7817,1.7807,1.7797,1.7787,1.7777,1.7767,1.7757,1.7747,1.7737,1.7727,1.7717,1.7707,1.7697,1.7687,1.7677,1.7667,1.7657,1.7647,1.7637,1.7627,1.7617,1.7607,1.7597,1.7587,1.7577,1.7567,1.7557,1.7547,1.7537,1.7527,1.7517,1.7507,1.7497,1.7487,1.7477,1.7467,1.7457,1.7447,1.7437,1.7427,1.7417,1.7407,1.7397,1.7387,1.7377,1.7367,1.7357,1.7347,1.7337,1.7327,1.7317,1.7307,1.7297,1.7287,1.7277,1.7267,1.7257,1.7247,1.7237,1.7227,1.7217,1.7207,1.7197,1.7187,1.7177,1.7167,1.7157,1.7147,1.7137,1.7127,1.7117,1.7107,1.7097,1.7087,1.7077,1.7067,1.7057,1.7047,1.7037,1.7027,1.7017,1.7007,1.6997,1.6987,1.6977,1.6967,1.6957,1.6947,1.6937,1.6927,1.6917,1.6907],"y":[0.0366190028700592,0.0379958920993461,0.039421976583705,0.0408988228959587,0.0424280332160472,0.0440112450231153,0.045650130677163,0.0473463968818115,0.0491017840194477,0.0509180653496957,0.0527970460619012,0.0547405621720483,0.0567504792543282,0.0588286909973711,0.0609771175750449,0.0631977038215939,0.0654924172009003,0.0678632455596451,0.0703121946542789,0.0728412854418809,0.0754525511252725,0.0781480339431178,0.0809297816962496,0.0837998440020388,0.0867602682693899,0.0898130953877966,0.0929603551249343,0.0962040612284298,0.0995462062288282,0.10298875594226,0.106533643673079,0.110182764118575,0.113937966980022,0.117801050286561,0.121773753440945,0.125857749998841,0.130054640196277,0.134365943242875,0.138793089401789,0.143337411880626,0.14800013856127,0.1527823836001,0.157685138933978,0.16270926573116,0.167855485830192,0.173124373213716,0.178516345567909,0.184031655981971,0.189670384845652,0.19543243200603,0.201317509247844,0.207325133164234,0.213454618487012,0.219705071947176,0.226075386737525,0.232564237649551,0.239170076956462,0.245891131112918,0.252725398340016,0.259670647160846,0.266724415947932,0.273884013538477,0.281146520967168,0.288508794358624,0.295967469013125,0.303518964709367,0.311159492237346,0.318885061162543,0.326691488810071,0.334574410443919,0.342529290602567,0.350551435537851,0.35863600668953,0.366778035113655,0.374972436769023,0.383214028552709,0.391497544963738,0.399817655263042,0.408168980989025,0.416546113680823,0.424943632656739,0.433356122692903,0.44177819144759,0.450204486479631,0.458629711715201,0.467048643225609,0.475456144189839,0.483847178928639,0.492216825912345,0.500560289661267,0.50887291147548,0.517150178949414,0.525387734245427,0.533581381118994,0.541727090705916,0.549821006098355,0.557859445751614,0.565838905776527,0.573756061183557,0.581607766153439,0.589391053415907,0.59710313282246,0.604741389201387,0.61230337958367,0.619786829886968,0.627189631141921,0.634509835340946,0.641745650984352,0.648895438392882,0.655957704849226,0.662931099624524,0.669814408939048,0.676606550899776,0.683306570451078,0.689913634368901,0.696427026323179,0.702846142028264,0.709170484496594,0.715399659406928,0.721533370594979,0.727571415671478,0.733513681770151,0.739360141426263,0.745110848584671,0.75076593473524,0.756325605172508,0.76179013537589,0.767159867506314,0.772435207014952,0.777616619359683,0.782704626824977,0.787699805441003,0.792602781998055,0.797414231152597,0.802134872621537,0.806765468461651,0.811306820431362,0.815759767432427,0.820125183029277,0.824403973044118,0.828597073226047,0.832705446992728,0.836730083243288,0.840671994241306,0.844532213566848,0.84831179413666,0.852011806291674,0.85563333595105,0.859177482832026,0.862645358734885,0.866038085892297,0.869356795382376,0.872602625604686,0.875776720818486,0.878880229742379,0.881914304214594,0.884880097912983,0.887778765133856,0.89061145962866,0.893379333497504,0.896083536138463,0.898725213251552,0.901305505896206,0.903825549601093,0.906286473524987,0.908689399667466,0.911035442128094,0.91332570641279,0.915561288785991,0.917743275667262,0.919872743070938,0.921950756087414,0.923978368404639,0.92595662186845,0.927886546080264,0.929769158030786,0.931605461768266,0.93339644809996,0.935143094325384,0.936846364000015,0.938507206728076,0.940126557983102,0.941705338954975,0.943244456422146,0.944744802647819,0.946207255298849,0.947632677386186,0.949021917225701,0.950375808418259,0.951695169847956,0.952980805697457,0.954233505479394,0.955454044082861,0.956643181834008,0.956643181834008,0.987441853255847,0.986955364208664,0.986450393882552,0.985926267361057,0.98538228713534,0.984817732506682,0.98423185898613,0.983623897692552,0.982993054750496,0.982338510689392,0.98165941984578,0.980954909770411,0.980224080642236,0.97946600469147,0.978679725634117,0.977864258120529,0.977018587200796,0.976141667809976,0.975232424276393,0.97428974985651,0.973312506300088,0.97229952344965,0.971249598878502,0.97016149757189,0.969033951656108,0.967865660180729,0.966655288959398,0.965401470474951,0.964102803854943,0.962757854923995,0.961365156339669,0.959923207818926,0.958430476462524,0.956885397185019,0.955286373258344,0.953631776977221,0.95191995045492,0.950149206558144,0.94831782999002,0.946424078530363,0.944466184442545,0.942442356056372,0.940350779536443,0.938189620845444,0.935957027911752,0.933651133010547,0.931270055367432,0.928811903993147,0.926274780757595,0.92365678371077,0.920956010657517,0.918170562992225,0.915298549798555,0.912338092218189,0.909287328091264,0.906144416869687,0.902907544802808,0.899574930393126,0.896144830117556,0.892615544407577,0.888985423879027,0.88525287579966,0.881416370779669,0.877474449667277,0.8734257306282,0.869268916384378,0.865002801583699,0.860626280268805,0.856138353409173,0.851538136456864,0.846824866882476,0.841997911644,0.837056774537664,0.832001103376292,0.826830696937568,0.821545511621695,0.816145667755501,0.810631455478301,0.805003340143449,0.799261967169217,0.793408166272888,0.787442955023399,0.781367541650157,0.775183327049237,0.768891905932731,0.762495067073004,0.755994792600629,0.749393256323202,0.742692821041603,0.735896034850946,0.729005626424853,0.722024499294042,0.714955725142937,0.707802536161236,0.700568316500389,0.693256592897856,0.685871024544124,0.678415392278751,0.670893587211565,0.663309598873482,0.655667503007788,0.647971449117104,0.640225647883161,0.632434358576369,0.624601876569281,0.616732521063227,0.608830623130156,0.600900514162747,0.592946514815182,0.584972924505069,0.57698401153416,0.568984003872332,0.560977080635788,0.552967364277591,0.544958913496042,0.536955716855173,0.528961687101285,0.520980656150689,0.513016370716488,0.505072488536489,0.497152575160092,0.489260101249383,0.481398440348212,0.473570867073136,0.465780555680929,0.458030578969463,0.450323907471241,0.442663408902165,0.43505184783157,0.427491885543376,0.41998608006196,0.412536886320185,0.405146656450564,0.397817640184021,0.390551985343712,0.38335173842427,0.376218845249167,0.369155151701094,0.362162404521878,0.355242252180008,0.348396245804791,0.341625840187097,0.334932394847095,0.328317175169763,0.321781353609061,0.315326010961612,0.308952137710518,0.30266063543974,0.296452318318963,0.290327914658597,0.284288068533934,0.278333341477149,0.27246421423519,0.266681088591261,0.260984289247027,0.255374065762329,0.249850594548711,0.244413980912817,0.239064261145268,0.233801404650521,0.228625316112861,0.223535837693602,0.218532751254402,0.21361578060155,0.208784593746038,0.204038805174255,0.199377978124159,0.194801626861917,0.190309218954045,0.185900177530307,0.18157388353272,0.177329677946271,0.173166864007091,0.169084709384129,0.165082448330532,0.161159283801242,0.157314389533531,0.153546912087487,0.149855972843678,0.146240669955532,0.142700080254196,0.139233261103891,0.135839252206045,0.132517077350725,0.129265746114101,0.12608425550095,0.122971591531379,0.119926730771181,0.116948641805428,0.1140362866551,0.111188622136709,0.108404601165073,0.105683173999507,0.103023289433889],"name":"95% conf.","mode":"lines","type":"scatter","hoveron":"points","fill":"toself","line":{"fillcolor":"rgba(44,160,44,1)","color":"rgba(138,43,226, 0.05)","opacity":0.1},"fillcolor":"rgba(138,43,226, 0.2)","opacity":0.25,"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<hr />
<div id="extra" class="section level4">
<h4>EXTRA</h4>
<hr />
<p></p>
<div id="avaliando-os-residuos" class="section level5">
<h5><strong>Avaliando os resíduos</strong>:</h5>
<p><strong>Plots resíduos vs valores ajustados:</strong></p>
<!-- para dividir a saida em 2 colunas com css-- eh a unica que funciona no browser!! -->
<!-- https://stackoverflow.com/questions/31753897/2-column-section-in-r-markdown -->
<!-- NAO FUNCIONA COM PLOTLY APENAS COM DYGRAPHS!!!! -->
<pre class="r"><code># outra forma de colocar os graficos lado a lado com plotly
# plotly::subplot(p2, p3)</code></pre>
<pre class="r"><code># colcando tudo no mesmo gráfico

# se usarmos ~variavel ele traz os nomes das variaveis nos eixos
plotly::plot_ly(x = fit$fitted.values, y = residuals(fit), 
                      name = &#39;Deviance&#39;, type = &#39;scatter&#39;, mode = &#39;markers&#39; ) %&gt;%
  # plotly::layout(title = &quot;Resíduos Deviance&quot;, xaxis = list(title=&quot;fitted&quot;), yaxis = list(title=&quot;resíduos&quot;)) %&gt;%
  plotly::add_trace(x = fit$fitted.values, y = ~fit$residuals, 
                      name = &#39;Pearson&#39;, type = &#39;scatter&#39;, mode = &#39;markers&#39;) %&gt;%
  plotly::layout(title = &quot;Resíduos&quot;, xaxis = list(title=&quot;fitted&quot;), yaxis = list(title=&quot;resíduos&quot;) )</code></pre>
<div id="38fa129a9419" style="width:864px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="38fa129a9419">{"x":{"visdat":{"38fa53f8db2e":["function () ","plotlyVisDat"]},"cur_data":"38fa53f8db2e","attrs":{"38fa53f8db2e":{"x":[0.0619789114524398,0.168253669815993,0.362938463010934,0.600125343762374,0.787704931366165,0.897173337252738,0.951254155255683,0.976707081302343],"y":[1.16462570201093,0.968486618588007,-1.20931086901212,-1.51389730184138,0.748922087652778,0.0286676878069518,1.37878443650609,0.358279313611872],"name":"Deviance","mode":"markers","alpha":1,"sizes":[10,100],"type":"scatter"},"38fa53f8db2e.1":{"x":[0.0619789114524398,0.168253669815993,0.362938463010934,0.600125343762374,0.787704931366165,0.897173337252738,0.951254155255683,0.976707081302343],"y":{},"name":"Pearson","mode":"markers","alpha":1,"sizes":[10,100],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Resíduos","xaxis":{"domain":[0,1],"title":"fitted"},"yaxis":{"domain":[0,1],"title":"resíduos"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[0.0619789114524398,0.168253669815993,0.362938463010934,0.600125343762374,0.787704931366165,0.897173337252738,0.951254155255683,0.976707081302343],"y":[1.16462570201093,0.968486618588007,-1.20931086901212,-1.51389730184138,0.748922087652778,0.0286676878069518,1.37878443650609,0.358279313611872],"name":"Deviance","mode":"markers","type":"scatter","marker":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y","frame":null},{"x":[0.0619789114524398,0.168253669815993,0.362938463010934,0.600125343762374,0.787704931366165,0.897173337252738,0.951254155255683,0.976707081302343],"y":[0.683138869897239,0.345944577957221,-0.31406333501719,-0.417232540903463,0.225395110663664,0.0122678213154326,0.703408074112607,0.291259234060894],"name":"Pearson","mode":"markers","type":"scatter","marker":{"fillcolor":"rgba(255,127,14,1)","color":"rgba(255,127,14,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<p></p>
<p>Com intervalo de confiança:</p>
<pre class="r"><code># library(plotly)
# library(broom)
# https://plot.ly/r/graphing-multiple-chart-types/#loess-smoother-with-uncertainty-bounds

m2 &lt;- loess(residuals(fit) ~ fit$fitted.values)

p2 &lt;- plotly::plot_ly(x = fit$fitted.values, 
                      y = residuals(fit)) %&gt;% # nao posso colocar a cor aqui
  plotly::add_markers(marker = list( color = &quot;blue&quot;), name = &quot;Deviance&quot; ) %&gt;% # tenho que adicionar uma cama especifica para alterar a cor
  plotly::add_lines(y = ~fitted(loess(residuals(fit) ~ fit$fitted.values)),
            line = list(color = &#39;rgba(138,43,226, 0.5)&#39;), # o ultimo valor eh opacity
            # cores em decimal em: https://reeddesign.co.uk/test/namedcolors.html
            name = &quot;Loess Smoother&quot;) %&gt;% 
  plotly::add_ribbons(data = broom::augment(m2),
              ymin = ~.fitted - qnorm(0.975) * .se.fit,
              ymax = ~.fitted + qnorm(0.975) * .se.fit,
              line = list(color = &#39;rgba(138,43,226, 0.05)&#39;, opacity = 0.1),
              fillcolor = &#39;rgba(138,43,226, 0.2)&#39;, opacity = 0.25,
              name = &quot;Standard Error&quot;) %&gt;%
  plotly::layout(title = &quot;Resíduos Deviance&quot;, 
                 xaxis = list(title=&quot;fitted&quot;), 
                 yaxis = list(title=&quot;resíduos&quot;))




m3 &lt;- loess(fit$residuals ~ fit$fitted.values)

p3 &lt;- plotly::plot_ly(x = fit$fitted.values, y = fit$residuals) %&gt;%
  plotly::add_markers(marker = list( color = &quot;orange&quot;), name = &quot;Pearson&quot; ) %&gt;% # tenho que adicionar uma cama especifica para alterar a cor
  plotly::add_lines(y = ~fitted(loess(fit$residuals ~ fit$fitted.values)),
            line = list(color = &#39;rgba(138,43,226, 0.5)&#39;),
            name = &quot;Loess Smoother&quot;) %&gt;%
  plotly::add_ribbons(data = broom::augment(m3),
              ymin = ~.fitted - qnorm(0.975) * .se.fit,
              ymax = ~.fitted + qnorm(0.975) * .se.fit,
              line = list(color = &#39;rgba(138,43,226, 0.05)&#39;, opacity = 0.1),
              fillcolor = &#39;rgba(138,43,226, 0.2)&#39;, opacity = 0.25,
              name = &quot;Standard Error&quot;) %&gt;%
  plotly::layout(title = &quot;Resíduos de Pearson&quot;, 
                 xaxis = list(title=&quot;fitted&quot;), 
                 yaxis = list(title=&quot;resíduos&quot;))</code></pre>
<div class="row">
<div class="col-md-6">
<pre class="r"><code>p2</code></pre>
<div id="38fa81c2afd" style="width:451.2px;height:384px;" class="plotly html-widget"></div>
<script type="application/json" data-for="38fa81c2afd">{"x":{"visdat":{"38faa076d64":["function () ","plotlyVisDat"],"38fa718bc184":["function () ","data"]},"cur_data":"38fa718bc184","attrs":{"38faa076d64":{"x":[0.0619789114524398,0.168253669815993,0.362938463010934,0.600125343762374,0.787704931366165,0.897173337252738,0.951254155255683,0.976707081302343],"y":[1.16462570201093,0.968486618588007,-1.20931086901212,-1.51389730184138,0.748922087652778,0.0286676878069518,1.37878443650609,0.358279313611872],"alpha":1,"sizes":[10,100],"type":"scatter","mode":"markers","marker":{"color":"blue"},"name":"Deviance"},"38faa076d64.1":{"x":[0.0619789114524398,0.168253669815993,0.362938463010934,0.600125343762374,0.787704931366165,0.897173337252738,0.951254155255683,0.976707081302343],"y":{},"alpha":1,"sizes":[10,100],"type":"scatter","mode":"lines","line":{"color":"rgba(138,43,226, 0.5)"},"name":"Loess Smoother"},"38fa718bc184":{"x":[0.0619789114524398,0.168253669815993,0.362938463010934,0.600125343762374,0.787704931366165,0.897173337252738,0.951254155255683,0.976707081302343],"y":[1.16462570201093,0.968486618588007,-1.20931086901212,-1.51389730184138,0.748922087652778,0.0286676878069518,1.37878443650609,0.358279313611872],"alpha":1,"sizes":[10,100],"ymin":{},"ymax":{},"type":"scatter","mode":"lines","hoveron":"points","fill":"toself","line":{"color":"rgba(138,43,226, 0.05)","opacity":0.1},"fillcolor":"rgba(138,43,226, 0.2)","opacity":0.25,"name":"Standard Error"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Resíduos Deviance","xaxis":{"domain":[0,1],"title":"fitted"},"yaxis":{"domain":[0,1],"title":"resíduos"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[0.0619789114524398,0.168253669815993,0.362938463010934,0.600125343762374,0.787704931366165,0.897173337252738,0.951254155255683,0.976707081302343],"y":[1.16462570201093,0.968486618588007,-1.20931086901212,-1.51389730184138,0.748922087652778,0.0286676878069518,1.37878443650609,0.358279313611872],"type":"scatter","mode":"markers","marker":{"fillcolor":"rgba(31,119,180,1)","color":"blue","line":{"color":"transparent"}},"name":"Deviance","xaxis":"x","yaxis":"y","frame":null},{"x":[0.0619789114524398,0.168253669815993,0.362938463010934,0.600125343762374,0.787704931366165,0.897173337252738,0.951254155255683,0.976707081302343],"y":[1.48957794248092,0.378770918260482,-1.0987294363355,-1.24544164143003,0.446998428700028,0.743373870708563,0.67759298571313,0.602848735237847],"type":"scatter","mode":"lines","line":{"fillcolor":"rgba(255,127,14,1)","color":"rgba(138,43,226, 0.5)"},"name":"Loess Smoother","xaxis":"x","yaxis":"y","frame":null},{"x":[0.0619789114524398,0.168253669815993,0.362938463010934,0.600125343762374,0.787704931366165,0.897173337252738,0.951254155255683,0.976707081302343,0.976707081302343,0.976707081302343,0.951254155255683,0.897173337252738,0.787704931366165,0.600125343762374,0.362938463010934,0.168253669815993,0.0619789114524398],"y":[0.105987199733523,-0.565271663904032,-2.29892315448478,-2.63762029370107,-0.878418580777415,-0.146938609844808,-0.238334302795091,-0.588946394523224,-0.588946394523224,1.79464386499892,1.59352027422135,1.63368635126193,1.77241543817747,0.146737010841004,0.101464281813773,1.322813500425,2.87316868522831],"type":"scatter","mode":"lines","hoveron":"points","fill":"toself","line":{"fillcolor":"rgba(44,160,44,1)","color":"rgba(138,43,226, 0.05)","opacity":0.1},"fillcolor":"rgba(138,43,226, 0.2)","opacity":0.25,"name":"Standard Error","xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
</div>
<div class="col-md-6">
<pre class="r"><code>p3</code></pre>
<div id="38fa221598e2" style="width:451.2px;height:384px;" class="plotly html-widget"></div>
<script type="application/json" data-for="38fa221598e2">{"x":{"visdat":{"38fa4581a705":["function () ","plotlyVisDat"],"38fadc210a8":["function () ","data"]},"cur_data":"38fadc210a8","attrs":{"38fa4581a705":{"x":[0.0619789114524398,0.168253669815993,0.362938463010934,0.600125343762374,0.787704931366165,0.897173337252738,0.951254155255683,0.976707081302343],"y":[0.683138869897239,0.345944577957221,-0.31406333501719,-0.417232540903463,0.225395110663664,0.0122678213154326,0.703408074112607,0.291259234060894],"alpha":1,"sizes":[10,100],"type":"scatter","mode":"markers","marker":{"color":"orange"},"name":"Pearson"},"38fa4581a705.1":{"x":[0.0619789114524398,0.168253669815993,0.362938463010934,0.600125343762374,0.787704931366165,0.897173337252738,0.951254155255683,0.976707081302343],"y":{},"alpha":1,"sizes":[10,100],"type":"scatter","mode":"lines","line":{"color":"rgba(138,43,226, 0.5)"},"name":"Loess Smoother"},"38fadc210a8":{"x":[0.0619789114524398,0.168253669815993,0.362938463010934,0.600125343762374,0.787704931366165,0.897173337252738,0.951254155255683,0.976707081302343],"y":[0.683138869897239,0.345944577957221,-0.31406333501719,-0.417232540903463,0.225395110663664,0.0122678213154326,0.703408074112607,0.291259234060894],"alpha":1,"sizes":[10,100],"ymin":{},"ymax":{},"type":"scatter","mode":"lines","hoveron":"points","fill":"toself","line":{"color":"rgba(138,43,226, 0.05)","opacity":0.1},"fillcolor":"rgba(138,43,226, 0.2)","opacity":0.25,"name":"Standard Error"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Resíduos de Pearson","xaxis":{"domain":[0,1],"title":"fitted"},"yaxis":{"domain":[0,1],"title":"resíduos"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[0.0619789114524398,0.168253669815993,0.362938463010934,0.600125343762374,0.787704931366165,0.897173337252738,0.951254155255683,0.976707081302343],"y":[0.683138869897239,0.345944577957221,-0.31406333501719,-0.417232540903463,0.225395110663664,0.0122678213154326,0.703408074112607,0.291259234060894],"type":"scatter","mode":"markers","marker":{"fillcolor":"rgba(31,119,180,1)","color":"orange","line":{"color":"transparent"}},"name":"Pearson","xaxis":"x","yaxis":"y","frame":null},{"x":[0.0619789114524398,0.168253669815993,0.362938463010934,0.600125343762374,0.787704931366165,0.897173337252738,0.951254155255683,0.976707081302343],"y":[0.730944797057236,0.260489623844739,-0.305233230662069,-0.34218373366912,0.106972329258597,0.307537983703382,0.383746861480457,0.416362478156091],"type":"scatter","mode":"lines","line":{"fillcolor":"rgba(255,127,14,1)","color":"rgba(138,43,226, 0.5)"},"name":"Loess Smoother","xaxis":"x","yaxis":"y","frame":null},{"x":[0.0619789114524398,0.168253669815993,0.362938463010934,0.600125343762374,0.787704931366165,0.897173337252738,0.951254155255683,0.976707081302343,0.976707081302343,0.976707081302343,0.951254155255683,0.897173337252738,0.787704931366165,0.600125343762374,0.362938463010934,0.168253669815993,0.0619789114524398],"y":[0.215897963617259,-0.0909337613759754,-0.752009835151244,-0.86042744857799,-0.386419114199097,-0.0238841700547138,0.0427894995724997,-0.0272877203655782,-0.0272877203655782,0.86001267667776,0.724704223388415,0.638960137461477,0.600363772716292,0.17605998123975,0.141543373827106,0.611913009065453,1.24599163049721],"type":"scatter","mode":"lines","hoveron":"points","fill":"toself","line":{"fillcolor":"rgba(44,160,44,1)","color":"rgba(138,43,226, 0.05)","opacity":0.1},"fillcolor":"rgba(138,43,226, 0.2)","opacity":0.25,"name":"Standard Error","xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
</div>
</div>
</div>
<div id="medidas-diagnostico-de-influencia" class="section level5">
<h5><strong>Medidas (diagnóstico) de influência</strong></h5>
<p><strong>Resíduos vs índices</strong></p>
<pre class="r"><code># ou com plotly:
library(dplyr)
# pontos e linhas no mesmo plot:
# https://plot.ly/r/line-and-scatter/

p2 &lt;- plotly::plot_ly(x = 1:length(residuals(fit)), y = residuals(fit), 
                      name = &#39;prop&#39;, type = &#39;scatter&#39;, mode = &#39;markers&#39;, marker = list( color = &quot;blue&quot;) ) %&gt;%
  plotly::layout(title = &quot;Resíduos Deviance&quot;, xaxis = list(title=&quot;índices&quot;), yaxis = list(title=&quot;resíduos&quot;))

p3 &lt;- plotly::plot_ly(x = 1:length(residuals(fit)), y = ~fit$residuals, 
                      name = &#39;prop&#39;, type = &#39;scatter&#39;, mode = &#39;markers&#39;, marker = list( color = &quot;green&quot;) )  %&gt;%
  plotly::layout(title = &quot;Resíduos de Pearson&quot;, xaxis = list(title=&quot;índices&quot;), yaxis = list(title=&quot;resíduos&quot;))
  
# se usarmos ~variavel ele traz os nomes das variaveis nos eixos</code></pre>
<div class="row">
<div class="col-md-6">
<pre class="r"><code>p2</code></pre>
<div id="38fa47081db0" style="width:384px;height:384px;" class="plotly html-widget"></div>
<script type="application/json" data-for="38fa47081db0">{"x":{"visdat":{"38fa6ce69b6b":["function () ","plotlyVisDat"]},"cur_data":"38fa6ce69b6b","attrs":{"38fa6ce69b6b":{"x":[1,2,3,4,5,6,7,8],"y":[1.16462570201093,0.968486618588007,-1.20931086901212,-1.51389730184138,0.748922087652778,0.0286676878069518,1.37878443650609,0.358279313611872],"name":"prop","mode":"markers","marker":{"color":"blue"},"alpha":1,"sizes":[10,100],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Resíduos Deviance","xaxis":{"domain":[0,1],"title":"índices"},"yaxis":{"domain":[0,1],"title":"resíduos"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[1,2,3,4,5,6,7,8],"y":[1.16462570201093,0.968486618588007,-1.20931086901212,-1.51389730184138,0.748922087652778,0.0286676878069518,1.37878443650609,0.358279313611872],"name":"prop","mode":"markers","marker":{"fillcolor":"rgba(31,119,180,1)","color":"blue","line":{"color":"transparent"}},"type":"scatter","xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
</div>
<div class="col-md-6">
<pre class="r"><code>p3</code></pre>
<div id="38fa480e5347" style="width:384px;height:384px;" class="plotly html-widget"></div>
<script type="application/json" data-for="38fa480e5347">{"x":{"visdat":{"38fa31d28a27":["function () ","plotlyVisDat"]},"cur_data":"38fa31d28a27","attrs":{"38fa31d28a27":{"x":[1,2,3,4,5,6,7,8],"y":{},"name":"prop","mode":"markers","marker":{"color":"green"},"alpha":1,"sizes":[10,100],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Resíduos de Pearson","xaxis":{"domain":[0,1],"title":"índices"},"yaxis":{"domain":[0,1],"title":"resíduos"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[1,2,3,4,5,6,7,8],"y":[0.683138869897239,0.345944577957221,-0.31406333501719,-0.417232540903463,0.225395110663664,0.0122678213154326,0.703408074112607,0.291259234060894],"name":"prop","mode":"markers","marker":{"fillcolor":"rgba(31,119,180,1)","color":"green","line":{"color":"transparent"}},"type":"scatter","xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
</div>
</div>
<pre class="r"><code>medinflu &lt;-influence.measures(fit)
inf_measures &lt;- tibble::as.tibble(medinflu$infmat)
inf_measures</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["dfb.1_"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["dfb.dose"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["dffit"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["cov.r"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["cook.d"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["hat"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.64728223","2":"-0.63905894","3":"0.71902845","4":"1.2176316","5":"0.4133337323","6":"0.2729679"},{"1":"0.56564012","2":"-0.55404175","3":"0.72034776","4":"1.5282221","5":"0.4008583110","6":"0.3436716"},{"1":"-0.40844230","2":"0.38950211","3":"-0.84084431","4":"1.1856681","5":"0.4467384875","6":"0.3051169"},{"1":"0.07723140","2":"-0.09958067","3":"-0.87782899","4":"0.8036580","5":"0.4461888107","6":"0.2275838"},{"1":"-0.23277480","2":"0.24156817","3":"0.41753981","4":"1.6278951","5":"0.1310425368","6":"0.2647299"},{"1":"-0.01075479","2":"0.01097933","3":"0.01396804","4":"1.8895396","5":"0.0001679972","6":"0.2380999"},{"1":"-0.60257545","2":"0.61146414","3":"0.69941911","4":"0.9471183","5":"0.2288368842","6":"0.2039104"},{"1":"-0.11048959","2":"0.11176763","3":"0.12184379","4":"1.6242063","5":"0.0113699931","6":"0.1439197"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Plotando valores de leverage (<em>hat</em>), <em>dffit</em>, <em>dfbeta</em> (para dose) e <em>cook distance</em>:</p>
<pre class="r"><code># separando as 4 medidas de interesse

inf_measures_sub &lt;- inf_measures %&gt;%
  dplyr::select(dfb.dose, dffit, cook.d, hat)</code></pre>
<pre class="r"><code># 1 plot para cada coluna
lista &lt;- lapply(1:ncol(inf_measures_sub),
            function(j) {
              plotly::plot_ly(x = 1:nrow(inf_measures_sub),
                      y = as.data.frame(inf_measures_sub)[,j],
                      mode = &quot;markers&quot;)
            })</code></pre>
<p><strong>Gráficos para medidas de Influência:</strong></p>
<div class="row">
<div class="col-md-6">
<pre class="r"><code>lista[[1]] %&gt;%
  plotly::layout(title = &quot;Dfbetas - Dose&quot;, xaxis = list(title=&quot;índices&quot;), yaxis = list(title=&quot;dfbetas&quot;))</code></pre>
<div id="38fa5e2fe2b6" style="width:451.2px;height:384px;" class="plotly html-widget"></div>
<script type="application/json" data-for="38fa5e2fe2b6">{"x":{"visdat":{"38fa43389114":["function () ","plotlyVisDat"]},"cur_data":"38fa43389114","attrs":{"38fa43389114":{"x":[1,2,3,4,5,6,7,8],"y":[-0.639058940536597,-0.554041748622803,0.389502113977927,-0.0995806665625219,0.241568173712509,0.0109793330557714,0.611464138806381,0.111767629035014],"mode":"markers","alpha":1,"sizes":[10,100]}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Dfbetas - Dose","xaxis":{"domain":[0,1],"title":"índices"},"yaxis":{"domain":[0,1],"title":"dfbetas"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[1,2,3,4,5,6,7,8],"y":[-0.639058940536597,-0.554041748622803,0.389502113977927,-0.0995806665625219,0.241568173712509,0.0109793330557714,0.611464138806381,0.111767629035014],"mode":"markers","type":"scatter","marker":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<pre class="r"><code>lista[[3]] %&gt;%
  plotly::layout(title = &quot;Cook&#39;s Distance&quot;, xaxis = list(title=&quot;índices&quot;), yaxis = list(title=&quot;cook&quot;))</code></pre>
<div id="38fa327df876" style="width:451.2px;height:384px;" class="plotly html-widget"></div>
<script type="application/json" data-for="38fa327df876">{"x":{"visdat":{"38fa23b189bb":["function () ","plotlyVisDat"]},"cur_data":"38fa23b189bb","attrs":{"38fa23b189bb":{"x":[1,2,3,4,5,6,7,8],"y":[0.413333732287004,0.400858310975544,0.446738487457277,0.446188810713511,0.131042536834917,0.000167997199752604,0.228836884198184,0.0113699931459307],"mode":"markers","alpha":1,"sizes":[10,100]}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Cook's Distance","xaxis":{"domain":[0,1],"title":"índices"},"yaxis":{"domain":[0,1],"title":"cook"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[1,2,3,4,5,6,7,8],"y":[0.413333732287004,0.400858310975544,0.446738487457277,0.446188810713511,0.131042536834917,0.000167997199752604,0.228836884198184,0.0113699931459307],"mode":"markers","type":"scatter","marker":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
</div>
<div class="col-md-6">
<pre class="r"><code>lista[[2]] %&gt;%
  plotly::layout(title = &quot;Dffit&quot;, xaxis = list(title=&quot;índices&quot;), yaxis = list(title=&quot;dffit&quot;))</code></pre>
<div id="38fa34c45299" style="width:451.2px;height:384px;" class="plotly html-widget"></div>
<script type="application/json" data-for="38fa34c45299">{"x":{"visdat":{"38fa10685f94":["function () ","plotlyVisDat"]},"cur_data":"38fa10685f94","attrs":{"38fa10685f94":{"x":[1,2,3,4,5,6,7,8],"y":[0.719028445584579,0.720347760166629,-0.840844311107004,-0.877828986043453,0.417539813856698,0.0139680447271544,0.699419114519754,0.121843789944932],"mode":"markers","alpha":1,"sizes":[10,100]}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Dffit","xaxis":{"domain":[0,1],"title":"índices"},"yaxis":{"domain":[0,1],"title":"dffit"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[1,2,3,4,5,6,7,8],"y":[0.719028445584579,0.720347760166629,-0.840844311107004,-0.877828986043453,0.417539813856698,0.0139680447271544,0.699419114519754,0.121843789944932],"mode":"markers","type":"scatter","marker":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<pre class="r"><code>lista[[4]] %&gt;%
  plotly::layout(title = &quot;Leverage (hat)&quot;, xaxis = list(title=&quot;índices&quot;), yaxis = list(title=&quot;leverage&quot;))</code></pre>
<div id="38fa1d659114" style="width:451.2px;height:384px;" class="plotly html-widget"></div>
<script type="application/json" data-for="38fa1d659114">{"x":{"visdat":{"38fa42866341":["function () ","plotlyVisDat"]},"cur_data":"38fa42866341","attrs":{"38fa42866341":{"x":[1,2,3,4,5,6,7,8],"y":[0.272967859458514,0.343671558043457,0.305116920315643,0.227583751766048,0.264729935917132,0.238099863589835,0.203910396982658,0.143919713926714],"mode":"markers","alpha":1,"sizes":[10,100]}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Leverage (hat)","xaxis":{"domain":[0,1],"title":"índices"},"yaxis":{"domain":[0,1],"title":"leverage"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[1,2,3,4,5,6,7,8],"y":[0.272967859458514,0.343671558043457,0.305116920315643,0.227583751766048,0.264729935917132,0.238099863589835,0.203910396982658,0.143919713926714],"mode":"markers","type":"scatter","marker":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
</div>
</div>
<hr />
<hr />
</div>
</div>
<div id="referencias-bibliograficas" class="section level3">
<h3>Referências Bibliográficas</h3>
<hr />
<p>AGRESTI, ALAN. <em>An Introduction to Categorical Data Analysis</em>. John Wiley &amp; Sons, second edition, 2007.</p>
<p>NOTAS DE AULA. <em>Análise de Dados Categorizados</em>. Curso de Graduação em Estatística, UnB, 2018.</p>
<p>R CORE TEAM. <em>R: A language and environment for statistical computing</em>. R Foundation for Statistical Computing, Vienna, Austria. URL <a href="https://www.R-project.org/" class="uri">https://www.R-project.org/</a>.</p>
<hr />
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
